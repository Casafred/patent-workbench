# 功能七专利号搜索修复需求

## 问题描述

功能七（权利要求处理器）中的专利号搜索功能无法正常工作，用户无法搜索到Excel中存在的专利号，无论是完整号码还是部分号码都搜不到。

## 根本原因分析

1. **专利号列识别失败**：智能列识别器的正则表达式过于严格，无法识别各种格式的专利号
2. **前端状态管理问题**：`claimsCurrentPatentColumn` 变量没有被正确设置和使用
3. **搜索逻辑缺陷**：搜索功能过度依赖自动列识别，缺少手动配置选项
4. **用户体验问题**：没有提供清晰的错误提示和手动配置界面

## 用户故事

### 1. 作为用户，我希望能够搜索Excel中的专利号
**验收标准：**
- 能够搜索完整的专利号
- 能够搜索专利号的部分内容
- 搜索结果准确显示匹配的行

### 2. 作为用户，我希望系统能自动识别专利号列
**验收标准：**
- 系统能识别常见的专利号列名（中英文）
- 系统能识别各种专利号格式（CN、US、EP等）
- 识别结果有明确的置信度显示

### 3. 作为用户，我希望能手动选择专利号列
**验收标准：**
- 当自动识别失败时，提供手动选择选项
- 手动选择界面清晰易用
- 选择后立即生效

### 4. 作为用户，我希望获得清晰的错误提示
**验收标准：**
- 当没有专利号列时，提供明确提示
- 当搜索无结果时，提供建议操作
- 错误信息具体且可操作

## 功能需求

### FR-1: 增强专利号格式识别
- 支持更宽松的专利号格式匹配
- 支持纯数字专利号
- 支持带特殊字符的专利号格式
- 支持不同国家的专利号格式

### FR-2: 改进列识别逻辑
- 优化列名关键词匹配
- 增加数据内容分析权重
- 提供多个候选列选项
- 支持用户确认识别结果

### FR-3: 添加手动配置功能
- 提供专利号列手动选择界面
- 支持实时预览选择效果
- 保存用户选择偏好
- 支持重新选择功能

### FR-4: 优化搜索体验
- 支持模糊搜索
- 支持多关键词搜索
- 提供搜索建议
- 显示搜索统计信息

## 非功能需求

### NFR-1: 性能要求
- 搜索响应时间 < 2秒
- 支持大文件（10000+行）搜索
- 内存使用优化

### NFR-2: 兼容性要求
- 兼容现有Excel文件格式
- 向后兼容现有功能
- 不影响权利要求处理流程

### NFR-3: 用户体验要求
- 界面响应流畅
- 错误提示友好
- 操作步骤简单直观

## 验收标准

### 基本功能验收
1. 上传包含专利号的Excel文件
2. 系统自动识别专利号列或提供手动选择
3. 能够成功搜索专利号（完整或部分）
4. 搜索结果准确显示

### 边界情况验收
1. 处理无专利号列的文件
2. 处理专利号格式不规范的情况
3. 处理大文件搜索性能
4. 处理特殊字符和编码问题

### 用户体验验收
1. 错误提示清晰明确
2. 手动配置界面易用
3. 搜索操作响应及时
4. 结果展示直观清楚

## 优先级

- **P0 (必须)**: 基本搜索功能修复
- **P1 (重要)**: 手动配置功能
- **P2 (一般)**: 搜索体验优化
- **P3 (可选)**: 高级搜索功能

## 风险评估

### 技术风险
- **中等**: 正则表达式修改可能影响现有识别
- **低**: 前端状态管理修改

### 业务风险
- **低**: 功能增强不会破坏现有流程
- **低**: 向后兼容性良好

## 成功指标

1. **功能指标**: 专利号搜索成功率 > 95%
2. **性能指标**: 搜索响应时间 < 2秒
3. **用户体验**: 用户操作步骤 < 3步
4. **错误处理**: 错误提示覆盖率 100%