# 功能六批量专利解读增强 - 需求文档

## 概述
为功能六（批量专利解读）添加两个核心增强功能：
1. 自定义解读模板系统
2. 专利"问一问"对话功能

## 功能一：自定义解读模板系统

### 当前问题
- 解读字段固定为8个预设字段（技术领域、创新点、技术方案等）
- 用户无法根据自己的需求定制解读维度
- 表格显示格式固定，不够灵活

### 需求描述
允许用户自定义解读模板，包括：
- 自定义字段名称和描述
- 自定义字段数量（不限于8个）
- 保存和管理多个模板
- 导入/导出模板配置
- 解读结果表格自动适配模板字段

### 功能要点
1. **模板管理界面**
   - 模板选择器（预设模板 + 自定义模板）
   - 添加/删除字段按钮
   - 字段配置：字段名、字段描述、字段类型（文本/列表）
   - 保存模板、删除模板、导出模板、导入模板

2. **预设模板**
   - 默认模板（当前8个字段）
   - 技术分析模板
   - 商业价值模板
   - 法律分析模板

3. **模板应用**
   - 解读时使用选定模板
   - 结果表格动态生成（根据模板字段）
   - Excel导出自动适配模板字段

## 功能二：专利"问一问"对话功能

### 需求描述
在每个批量检索的专利显示卡片中，添加"问一问"按钮，点击后弹出简化对话窗口，允许用户针对该专利进行自由提问。

### 功能要点
1. **触发入口**
   - 在每个专利结果卡片的标题栏添加"问一问"按钮
   - 按钮样式：小型图标按钮，不占用过多空间

2. **对话窗口**
   - 模态弹窗形式
   - 显示专利基本信息（专利号、标题）
   - 简化的聊天界面（类似功能一，但更轻量）
   - 自动将专利完整内容作为上下文

3. **对话功能**
   - 用户输入问题
   - AI基于专利内容回答
   - 支持多轮对话
   - 对话历史保留（在弹窗关闭前）

4. **技术实现**
   - 复用功能一的chat API
   - 专利内容自动注入为system context
   - 独立的对话状态管理（不影响功能一）

## 用户场景

### 场景1：自定义模板
1. 用户进入功能六
2. 点击"模板管理"按钮
3. 创建新模板"竞品分析"
4. 添加字段：核心技术、竞争优势、市场定位、专利壁垒
5. 保存模板
6. 批量查询专利后，选择"竞品分析"模板进行解读
7. 导出Excel，字段自动匹配模板

### 场景2：专利问一问
1. 用户批量查询10个专利
2. 对某个专利感兴趣，点击"问一问"按钮
3. 弹出对话窗口，显示专利基本信息
4. 用户提问："这个专利的核心创新点是什么？"
5. AI基于专利内容回答
6. 用户继续提问："与现有技术相比有什么优势？"
7. AI继续回答
8. 用户关闭对话窗口，继续查看其他专利

## 技术约束
- 模板配置存储在localStorage
- 对话窗口不影响主界面状态
- 专利内容作为context注入，不重复发送
- 支持移动端响应式布局

## 优先级
- P0: 自定义模板基础功能（添加/删除字段、保存模板）
- P0: 专利问一问基础功能（弹窗、单轮对话）
- P1: 模板导入/导出
- P1: 多轮对话历史
- P2: 预设模板库扩展
