# 需求文档

## 介绍

专利权利要求处理功能允许用户上传包含专利权利要求文本的Excel文件，系统将自动解析每个单元格中的权利要求内容，提取权利要求序号，并识别独立权利要求和从属权利要求。

## 术语表

- **System**: 专利权利要求处理系统
- **Excel_File**: 包含专利权利要求文本的Excel文件
- **Claims_Text**: 单元格中的权利要求文本内容
- **Claim_Number**: 权利要求序号（数字）
- **Independent_Claim**: 独立权利要求（不引用其他权利要求）
- **Dependent_Claim**: 从属权利要求（引用其他权利要求）
- **Claims_Parser**: 权利要求解析器
- **Claims_Extractor**: 权利要求提取器
- **Language_Version**: 语言版本（英文、中文或其他语言）
- **Claim_Sequence**: 权利要求序号序列
- **Language_Priority**: 语言优先级（英文 > 中文 > 其他语言）

## 需求

### 需求 1: Excel文件上传和处理

**用户故事:** 作为用户，我希望能够上传包含专利权利要求文本的Excel文件，以便系统能够处理其中的权利要求内容。

#### 验收标准

1. 当用户上传Excel文件时，系统应当验证文件格式并成功读取文件内容
2. 当Excel文件包含多个工作表时，系统应当允许用户选择要处理的工作表
3. 当Excel文件包含多列数据时，系统应当允许用户指定包含权利要求文本的列
4. 如果上传的文件不是有效的Excel格式，系统应当返回明确的错误信息

### 需求 2: 多语言权利要求文本解析

**用户故事:** 作为用户，我希望系统能够处理包含多种语言版本的权利要求文本，并自动选择最优的语言版本进行解析。

#### 验收标准

1. 当单元格包含多种语言版本的权利要求时，系统应当通过序号连续性识别不同语言版本的边界
2. 当检测到多种语言版本时，系统应当按照优先级选择语言版本：英文 > 中文 > 其他语言
3. 当权利要求序号格式在不同语言中不一致时，系统应当适应不同的序号格式模式
4. 当无法确定语言类型时，系统应当默认处理第一个完整的权利要求序列

### 需求 3: 权利要求文本解析和提取

**用户故事:** 作为用户，我希望系统能够从选定的语言版本中提取所有权利要求内容，以便进行进一步的分析处理。

#### 验收标准

1. 当处理单元格文本时，系统应当识别并提取所有权利要求序号
2. 当权利要求序号为连续数字时，系统应当正确分割每个权利要求的文本内容
3. 当权利要求文本格式不规范时，系统应当尽可能提取有效的权利要求内容
4. 当单元格为空或不包含权利要求时，系统应当跳过该单元格并记录处理状态

### 需求 4: 权利要求序号识别和语言检测

**用户故事:** 作为用户，我希望系统能够准确识别不同语言版本中的权利要求序号，并处理各种序号格式变化。

#### 验收标准

1. 当权利要求文本包含不同语言的数字序号时，系统应当识别并适应各种序号格式
2. 当权利要求序号出现重新从1开始的情况时，系统应当识别为新语言版本的开始
3. 当权利要求序号不连续时，系统应当记录缺失的序号并继续处理当前语言版本
4. 当权利要求序号格式异常时，系统应当尝试标准化处理并记录异常情况

### 需求 5: 独立权利要求和从属权利要求识别

**用户故事:** 作为用户，我希望系统能够自动区分独立权利要求和从属权利要求，以便了解专利的权利要求结构。

#### 验收标准

1. 当权利要求文本中包含"权利要求"、"claim"或其他语言的等效词汇时，系统应当将其标识为从属权利要求
2. 当权利要求文本中不包含引用词汇时，系统应当将其标识为独立权利要求
3. 当系统识别从属权利要求时，系统应当提取其引用的权利要求序号（支持多语言格式）
4. 当权利要求类型识别存在歧义时，系统应当标记为待确认状态

### 需求 6: 处理结果输出

**用户故事:** 作为用户，我希望系统能够以结构化的方式输出处理结果，以便查看和使用解析后的权利要求信息。

#### 验收标准

1. 当处理完成时，系统应当生成包含所有权利要求信息的结构化数据，包括选定的语言版本
2. 当输出结果时，系统应当包含权利要求序号、类型（独立/从属）、引用关系、原始文本和语言标识
3. 当用户请求导出时，系统应当支持将结果导出为Excel或JSON格式，并标明处理的语言版本
4. 当处理过程中出现错误时，系统应当在结果中包含详细的错误报告和处理统计信息

### 需求 7: 数据验证和错误处理

**用户故事:** 作为系统管理员，我希望系统能够验证输入数据的完整性并妥善处理各种异常情况，以确保系统的稳定性和可靠性。

#### 验收标准

1. 当输入数据格式错误时，系统应当返回具体的错误信息和修正建议
2. 当权利要求文本解析失败时，系统应当记录失败原因并继续处理其他数据
3. 当系统资源不足时，系统应当优雅地处理大文件并提供进度反馈
4. 当处理过程被中断时，系统应当保存已处理的结果并允许恢复处理