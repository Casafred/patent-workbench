# 功能八诊断工具 - 正确使用方法

## ⚠️ 重要提示

**不要直接双击打开HTML文件！** 这会导致CORS错误。

## ✅ 正确的使用方法

### 步骤1: 启动应用

```bash
python run_app.py
```

等待看到类似这样的输出：
```
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.x.x:5000
```

### 步骤2: 在浏览器中访问

打开浏览器，访问：
```
http://localhost:5000/test_drawing_marker_debug.html
```

或者：
```
http://127.0.0.1:5000/test_drawing_marker_debug.html
```

**✨ 无需登录！** 诊断工具已配置为本地访问时自动绕过认证。

### 步骤3: 使用诊断工具

1. 上传专利附图
2. 输入说明书内容
3. 点击"测试说明书解析"
4. 点击"开始完整测试"

## ❌ 错误的使用方法

**不要这样做：**
- ❌ 双击打开 `test_drawing_marker_debug.html`
- ❌ 使用 `file:///C:/...` 路径访问
- ❌ 不启动应用就打开HTML文件

**这些方法会导致：**
```
Access to fetch at 'file:///C:/api/drawing-marker/process' from origin 'null' 
has been blocked by CORS policy
```

## 🔧 为什么必须通过HTTP访问？

1. **CORS限制:** 浏览器不允许 `file://` 协议的页面访问 `http://` 的API
2. **安全策略:** 现代浏览器的安全策略禁止跨协议请求
3. **API调用:** 诊断工具需要调用后端API，必须在同一协议下

## 🎉 好消息

**诊断工具无需登录！** 

当你从本地（localhost/127.0.0.1）访问时，系统会自动绕过认证，让你可以直接使用诊断功能。

## 📝 快速检查清单

- [ ] 已启动应用（`python run_app.py`）
- [ ] 使用浏览器访问 `http://localhost:5000/test_drawing_marker_debug.html`
- [ ] 看到诊断工具界面
- [ ] 可以上传图片和输入说明书

## 🆘 常见问题

### Q: 为什么我双击打开HTML文件会报错？

A: 因为HTML文件需要调用后端API（`/api/drawing-marker/process`），而浏览器不允许 `file://` 协议访问 `http://` 协议的资源。

### Q: 我必须启动应用吗？

A: 是的，必须启动应用。诊断工具需要调用后端API来处理图片和说明书。

### Q: 可以用IP地址访问吗？

A: 可以，如果应用显示：
```
* Running on http://192.168.1.100:5000
```

你可以访问：
```
http://192.168.1.100:5000/test_drawing_marker_debug.html
```

## 🎯 完整流程示例

```bash
# 1. 打开命令行
cd /path/to/patent-workbench

# 2. 启动应用
python run_app.py

# 3. 等待启动完成，看到：
#    * Running on http://127.0.0.1:5000

# 4. 打开浏览器，访问：
#    http://localhost:5000/test_drawing_marker_debug.html

# 5. 使用诊断工具
```

---

**记住:** 必须通过 `http://localhost:5000/` 访问，不能直接打开HTML文件！
