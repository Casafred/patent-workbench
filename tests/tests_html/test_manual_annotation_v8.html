<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ‰‹åŠ¨æ ‡æ³¨æµ‹è¯• - v8.0</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            padding: 30px;
        }
        
        h1 {
            color: #333;
            margin-bottom: 10px;
            font-size: 32px;
        }
        
        .badge {
            display: inline-block;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 20px;
        }
        
        .feature-box {
            background: linear-gradient(135deg, #f0f7ff 0%, #e8f4f8 100%);
            border-left: 4px solid #2196F3;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
        }
        
        .feature-box h3 {
            color: #2196F3;
            margin-bottom: 15px;
            font-size: 20px;
        }
        
        .feature-list {
            list-style: none;
            padding: 0;
        }
        
        .feature-list li {
            padding: 8px 0;
            color: #555;
        }
        
        .feature-list li:before {
            content: "âœ“ ";
            color: #4caf50;
            font-weight: bold;
            margin-right: 8px;
        }
        
        .demo-area {
            margin-top: 30px;
        }
        
        .demo-button {
            width: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 40px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 20px;
            font-weight: bold;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        
        .demo-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }
        
        .instructions {
            background: linear-gradient(135deg, #fff3cd 0%, #ffe8a1 100%);
            border-left: 4px solid #ffc107;
            padding: 20px;
            margin-top: 20px;
            border-radius: 8px;
        }
        
        .instructions h3 {
            color: #856404;
            margin-bottom: 15px;
            font-size: 20px;
        }
        
        .step {
            background-color: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 6px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .step-number {
            display: inline-block;
            width: 30px;
            height: 30px;
            background-color: #ffc107;
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            font-weight: bold;
            margin-right: 10px;
        }
        
        .visual-demo {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }
        
        .visual-demo h4 {
            color: #555;
            margin-bottom: 15px;
        }
        
        .demo-canvas {
            width: 100%;
            max-width: 600px;
            height: 300px;
            background-color: white;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            margin: 0 auto;
            display: block;
            cursor: crosshair;
        }
        
        .tip {
            background-color: #d1ecf1;
            border-left: 4px solid #17a2b8;
            padding: 15px;
            margin-top: 20px;
            border-radius: 4px;
            color: #0c5460;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¯ æ‰‹åŠ¨æ ‡æ³¨åŠŸèƒ½æµ‹è¯•</h1>
        <span class="badge">v8.0 - åŒå‡»ä½ç½®ä½œä¸ºæ ‡æ³¨ç‚¹</span>
        
        <div class="feature-box">
            <h3>ğŸš€ æ ¸å¿ƒæ”¹è¿›</h3>
            <ul class="feature-list">
                <li>åŒå‡»ä½ç½®å°±æ˜¯æ ‡æ³¨ç‚¹ï¼ˆç²¾ç¡®å®šä½ï¼‰</li>
                <li>è‡ªåŠ¨ç»˜åˆ¶è¿æ¥çº¿ï¼ˆä»æ ‡æ³¨ç‚¹åˆ°æ ‡ç­¾ï¼‰</li>
                <li>æ™ºèƒ½æ ‡ç­¾åç§»ï¼ˆé¿å…é®æŒ¡æ ‡æ³¨ç‚¹ï¼‰</li>
                <li>è¾¹ç•Œè‡ªåŠ¨æ£€æŸ¥ï¼ˆç¡®ä¿æ ‡ç­¾å¯è§ï¼‰</li>
                <li>é«˜äº®æ˜¾ç¤ºæ”¯æŒï¼ˆç‚¹å‡»åˆ—è¡¨é«˜äº®ï¼‰</li>
            </ul>
        </div>
        
        <div class="demo-area">
            <h2 style="color: #555; margin-bottom: 15px;">ğŸ“¸ æ¼”ç¤ºå›¾ç‰‡</h2>
            <button class="demo-button" onclick="openDemo()">
                ğŸ–¼ï¸ æ‰“å¼€æ¼”ç¤ºå›¾ç‰‡ï¼ˆç‚¹å‡»æµ‹è¯•æ‰‹åŠ¨æ ‡æ³¨ï¼‰
            </button>
        </div>
        
        <div class="instructions">
            <h3>ğŸ“– ä½¿ç”¨è¯´æ˜</h3>
            
            <div class="step">
                <span class="step-number">1</span>
                <strong>æ‰“å¼€æŸ¥çœ‹å™¨</strong><br>
                ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®æ‰“å¼€æ¼”ç¤ºå›¾ç‰‡
            </div>
            
            <div class="step">
                <span class="step-number">2</span>
                <strong>åŒå‡»æ·»åŠ æ ‡æ³¨</strong><br>
                åœ¨å›¾ç‰‡ä¸Šä»»æ„ä½ç½®åŒå‡»ï¼Œä¼šå¼¹å‡ºè¾“å…¥æ¡†
            </div>
            
            <div class="step">
                <span class="step-number">3</span>
                <strong>è¾“å…¥æ ‡æ³¨ä¿¡æ¯</strong><br>
                ç¬¬ä¸€ä¸ªè¾“å…¥æ¡†ï¼šè¾“å…¥æ ‡è®°åºå·ï¼ˆå¦‚ "100"ï¼‰<br>
                ç¬¬äºŒä¸ªè¾“å…¥æ¡†ï¼šè¾“å…¥æ ‡è®°è¯´æ˜ï¼ˆå¦‚ "æ–°å¢éƒ¨ä»¶"ï¼‰
            </div>
            
            <div class="step">
                <span class="step-number">4</span>
                <strong>æŸ¥çœ‹æ ‡æ³¨æ•ˆæœ</strong><br>
                - æ ‡æ³¨ç‚¹ï¼šå°±åœ¨åŒå‡»ä½ç½®<br>
                - è¿æ¥çº¿ï¼šä»æ ‡æ³¨ç‚¹åˆ°æ ‡ç­¾<br>
                - æ ‡ç­¾æ–‡å­—ï¼šè‡ªåŠ¨åç§»ï¼Œé¿å…é®æŒ¡<br>
                - åˆ—è¡¨æ˜¾ç¤ºï¼šæ ‡è®°ä¸º"(æ‰‹åŠ¨)"
            </div>
            
            <div class="step">
                <span class="step-number">5</span>
                <strong>æµ‹è¯•å…¶ä»–åŠŸèƒ½</strong><br>
                - ç‚¹å‡»æ ‡æ³¨åˆ—è¡¨ï¼šé«˜äº®å¯¹åº”æ ‡è®°<br>
                - æ—‹è½¬å›¾ç‰‡ï¼šæµ‹è¯•æ ‡æ³¨æ˜¯å¦æ­£ç¡®<br>
                - ç¼©æ”¾å›¾ç‰‡ï¼šæµ‹è¯•æ ‡æ³¨æ˜¯å¦æ¸…æ™°<br>
                - æ·»åŠ å¤šä¸ªæ ‡æ³¨ï¼šæµ‹è¯•è¾¹ç•Œå¤„ç†
            </div>
        </div>
        
        <div class="visual-demo">
            <h4>ğŸ¨ æ ‡æ³¨æ•ˆæœç¤ºæ„</h4>
            <canvas id="demoCanvas" class="demo-canvas"></canvas>
            <p style="text-align: center; margin-top: 10px; color: #666; font-size: 14px;">
                â†‘ åŒå‡»ç”»å¸ƒä»»æ„ä½ç½®æ·»åŠ æ ‡æ³¨ï¼ˆæ¼”ç¤ºç”¨ï¼‰
            </p>
        </div>
        
        <div class="tip">
            <strong>ğŸ’¡ æç¤ºï¼š</strong><br>
            - åŒå‡»ä½ç½®ä¼šä½œä¸ºæ ‡æ³¨ç‚¹ï¼ˆçº¢è‰²åœ†ç‚¹ï¼‰<br>
            - æ ‡ç­¾ä¼šè‡ªåŠ¨åç§»åˆ°åˆé€‚ä½ç½®<br>
            - é è¿‘è¾¹ç•Œæ—¶ä¼šè‡ªåŠ¨è°ƒæ•´æ–¹å‘<br>
            - è¿æ¥çº¿ä¼šä»æ ‡æ³¨ç‚¹è¿åˆ°æ ‡ç­¾<br>
            - æ‰€æœ‰æ ‡æ³¨éƒ½å¯ä»¥é«˜äº®æ˜¾ç¤º
        </div>
    </div>
    
    <script src="frontend/js/multiImageViewer_v8.js"></script>
    <script>
        // åˆ›å»ºæ¼”ç¤ºå›¾ç‰‡
        function createDemoImage() {
            const canvas = document.createElement('canvas');
            canvas.width = 800;
            canvas.height = 600;
            const ctx = canvas.getContext('2d');
            
            // èƒŒæ™¯
            ctx.fillStyle = '#e3f2fd';
            ctx.fillRect(0, 0, 800, 600);
            
            // ç½‘æ ¼
            ctx.strokeStyle = '#ddd';
            ctx.lineWidth = 1;
            for (let i = 0; i < 800; i += 50) {
                ctx.beginPath();
                ctx.moveTo(i, 0);
                ctx.lineTo(i, 600);
                ctx.stroke();
            }
            for (let i = 0; i < 600; i += 50) {
                ctx.beginPath();
                ctx.moveTo(0, i);
                ctx.lineTo(800, i);
                ctx.stroke();
            }
            
            // æ ‡é¢˜
            ctx.fillStyle = '#333';
            ctx.font = 'bold 32px Arial';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText('åŒå‡»ä»»æ„ä½ç½®æ·»åŠ æ ‡æ³¨', 400, 300);
            
            // æç¤º
            ctx.font = '20px Arial';
            ctx.fillStyle = '#666';
            ctx.fillText('æ ‡æ³¨ç‚¹ä¼šåœ¨åŒå‡»ä½ç½®ï¼Œæ ‡ç­¾ä¼šè‡ªåŠ¨åç§»', 400, 350);
            
            return canvas.toDataURL();
        }
        
        // æ‰“å¼€æ¼”ç¤º
        function openDemo() {
            const images = [{
                url: createDemoImage(),
                title: 'æ¼”ç¤ºå›¾ç‰‡ - æµ‹è¯•æ‰‹åŠ¨æ ‡æ³¨',
                detectedNumbers: [
                    { x: 200, y: 150, number: '1', name: 'ç¤ºä¾‹æ ‡æ³¨1' },
                    { x: 600, y: 150, number: '2', name: 'ç¤ºä¾‹æ ‡æ³¨2' },
                    { x: 400, y: 450, number: '3', name: 'ç¤ºä¾‹æ ‡æ³¨3' }
                ],
                referenceMap: {
                    '1': 'ç¤ºä¾‹æ ‡æ³¨1',
                    '2': 'ç¤ºä¾‹æ ‡æ³¨2',
                    '3': 'ç¤ºä¾‹æ ‡æ³¨3'
                }
            }];
            
            const viewer = new MultiImageViewerV8(images, {
                fontSize: 22,
                highlightColor: '#FFD700'
            });
            viewer.open(0);
        }
        
        // ç®€å•æ¼”ç¤ºç”»å¸ƒ
        const demoCanvas = document.getElementById('demoCanvas');
        const demoCtx = demoCanvas.getContext('2d');
        const annotations = [];
        
        // è®¾ç½®ç”»å¸ƒå°ºå¯¸
        demoCanvas.width = 600;
        demoCanvas.height = 300;
        
        // ç»˜åˆ¶èƒŒæ™¯
        function drawDemo() {
            demoCtx.clearRect(0, 0, demoCanvas.width, demoCanvas.height);
            
            // èƒŒæ™¯
            demoCtx.fillStyle = '#f8f9fa';
            demoCtx.fillRect(0, 0, demoCanvas.width, demoCanvas.height);
            
            // æç¤ºæ–‡å­—
            if (annotations.length === 0) {
                demoCtx.fillStyle = '#999';
                demoCtx.font = '16px Arial';
                demoCtx.textAlign = 'center';
                demoCtx.textBaseline = 'middle';
                demoCtx.fillText('åŒå‡»ç”»å¸ƒæ·»åŠ æ ‡æ³¨', demoCanvas.width / 2, demoCanvas.height / 2);
            }
            
            // ç»˜åˆ¶æ ‡æ³¨
            annotations.forEach(ann => {
                // æ ‡æ³¨ç‚¹ï¼ˆçº¢è‰²åœ†ç‚¹ï¼‰
                demoCtx.beginPath();
                demoCtx.arc(ann.markerX, ann.markerY, 5, 0, Math.PI * 2);
                demoCtx.fillStyle = '#FF5722';
                demoCtx.fill();
                
                // è¿æ¥çº¿
                demoCtx.beginPath();
                demoCtx.moveTo(ann.markerX, ann.markerY);
                demoCtx.lineTo(ann.labelX, ann.labelY);
                demoCtx.strokeStyle = '#FF5722';
                demoCtx.lineWidth = 2;
                demoCtx.stroke();
                
                // æ ‡ç­¾æ–‡å­—
                const text = `${ann.number}: ${ann.name}`;
                demoCtx.font = 'bold 14px Arial';
                demoCtx.textAlign = 'left';
                demoCtx.textBaseline = 'middle';
                
                // ç™½è‰²æè¾¹
                demoCtx.strokeStyle = '#FFFFFF';
                demoCtx.lineWidth = 3;
                demoCtx.strokeText(text, ann.labelX, ann.labelY);
                
                // æ–‡å­—
                demoCtx.fillStyle = '#FF5722';
                demoCtx.fillText(text, ann.labelX, ann.labelY);
            });
        }
        
        // åŒå‡»æ·»åŠ æ ‡æ³¨
        demoCanvas.addEventListener('dblclick', (e) => {
            const rect = demoCanvas.getBoundingClientRect();
            const clickX = e.clientX - rect.left;
            const clickY = e.clientY - rect.top;
            
            const number = prompt('è¯·è¾“å…¥æ ‡è®°åºå·ï¼š');
            if (!number) return;
            
            const name = prompt('è¯·è¾“å…¥æ ‡è®°è¯´æ˜ï¼š');
            if (!name) return;
            
            // æ™ºèƒ½è®¡ç®—æ ‡ç­¾ä½ç½®
            const offsetDistance = 60;
            let labelX = clickX + offsetDistance;
            let labelY = clickY - offsetDistance;
            
            if (labelX > demoCanvas.width - 80) {
                labelX = clickX - offsetDistance;
            }
            if (labelY < 30) {
                labelY = clickY + offsetDistance;
            }
            
            annotations.push({
                markerX: clickX,
                markerY: clickY,
                labelX: labelX,
                labelY: labelY,
                number: number,
                name: name
            });
            
            drawDemo();
        });
        
        // åˆå§‹ç»˜åˆ¶
        drawDemo();
        
        console.log('âœ… æ‰‹åŠ¨æ ‡æ³¨æµ‹è¯•é¡µé¢åŠ è½½å®Œæˆ');
        console.log('ğŸ¯ åŒå‡»ä½ç½®ä½œä¸ºæ ‡æ³¨ç‚¹');
        console.log('ğŸ“ æ™ºèƒ½æ ‡ç­¾åç§»');
        console.log('ğŸ”— è‡ªåŠ¨ç»˜åˆ¶è¿æ¥çº¿');
    </script>
</body>
</html>
