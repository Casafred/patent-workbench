# è¿œç¨‹æ›´æ–°é˜¿é‡Œäº‘æœåŠ¡å™¨è¯´æ˜ ğŸš€

## ä½ çš„æ—§å‘½ä»¤åˆ†æ

### âŒ æ—§å‘½ä»¤ï¼ˆä¸èƒ½ç”¨ï¼‰
```bash
ssh root@43.99.101.195 "su - appuser -c 'cd ~/patent-app && git pull origin main' && systemctl restart patent-app"
```

### é—®é¢˜åˆ†æ
| é¡¹ç›® | æ—§å‘½ä»¤ | å®é™…æƒ…å†µ | çŠ¶æ€ |
|------|--------|----------|------|
| ç”¨æˆ· | appuser | root | âŒ é”™è¯¯ |
| è·¯å¾„ | ~/patent-app | /www/wwwroot/patent-workbench | âŒ é”™è¯¯ |
| æœåŠ¡ | patent-app | gunicorn | âŒ é”™è¯¯ |

**ç»“è®ºï¼šæ—§å‘½ä»¤å®Œå…¨ä¸èƒ½ç”¨ï¼Œéœ€è¦æ›´æ–°ï¼**

---

## âœ… æ–°å‘½ä»¤ï¼ˆæ­£ç¡®ç‰ˆæœ¬ï¼‰

### æ–¹æ³•1ï¼šä¸€é”®å‘½ä»¤ï¼ˆæœ€å¿«ï¼‰â­

å¤åˆ¶ç²˜è´´åˆ°æœ¬åœ°CMDæˆ–PowerShellï¼š

```bash
ssh root@43.99.101.195 "cd /www/wwwroot/patent-workbench && git pull origin main && if grep -q '127.0.0.1:5000' gunicorn_config.py; then sed -i 's/127.0.0.1:5000/0.0.0.0:5000/g' gunicorn_config.py && echo 'é…ç½®å·²ä¿®å¤'; fi && systemctl restart gunicorn && systemctl status gunicorn | grep Active"
```

### æ–¹æ³•2ï¼šä½¿ç”¨æ‰¹å¤„ç†è„šæœ¬ï¼ˆæ¨èï¼‰

åŒå‡»è¿è¡Œï¼š
```
è¿œç¨‹æ›´æ–°é˜¿é‡Œäº‘.bat
```

**ä¼˜ç‚¹ï¼š**
- è‡ªåŠ¨æ£€æŸ¥SSHè¿æ¥
- è‡ªåŠ¨æ‹‰å–ä»£ç 
- è‡ªåŠ¨ä¿®å¤é…ç½®
- è‡ªåŠ¨é‡å¯æœåŠ¡
- è‡ªåŠ¨éªŒè¯çŠ¶æ€
- æœ‰è¯¦ç»†çš„è¿›åº¦æç¤º

### æ–¹æ³•3ï¼šåˆ†æ­¥æ‰§è¡Œï¼ˆè¯¦ç»†ï¼‰

```bash
# æ­¥éª¤1ï¼šæ‹‰å–ä»£ç 
ssh root@43.99.101.195 "cd /www/wwwroot/patent-workbench && git pull origin main"

# æ­¥éª¤2ï¼šæ£€æŸ¥é…ç½®
ssh root@43.99.101.195 "cd /www/wwwroot/patent-workbench && cat gunicorn_config.py | grep bind"

# æ­¥éª¤3ï¼šä¿®å¤é…ç½®ï¼ˆå¦‚æœæ˜¾ç¤º127.0.0.1ï¼‰
ssh root@43.99.101.195 "cd /www/wwwroot/patent-workbench && sed -i 's/127.0.0.1:5000/0.0.0.0:5000/g' gunicorn_config.py"

# æ­¥éª¤4ï¼šé‡å¯æœåŠ¡
ssh root@43.99.101.195 "systemctl restart gunicorn"

# æ­¥éª¤5ï¼šæ£€æŸ¥çŠ¶æ€
ssh root@43.99.101.195 "systemctl status gunicorn"
```

---

## ğŸ“‹ å®Œæ•´æ›´æ–°æµç¨‹

### æœ¬åœ°æ“ä½œ
1. æ¨é€ä»£ç åˆ°GitHub
   ```bash
   å¿«é€Ÿæ¨é€åŠŸèƒ½å…«.bat
   ```

2. è¿œç¨‹æ›´æ–°æœåŠ¡å™¨
   ```bash
   è¿œç¨‹æ›´æ–°é˜¿é‡Œäº‘.bat
   ```

### éªŒè¯æµ‹è¯•
1. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜ï¼ˆCtrl+Shift+Deleteï¼‰
2. è®¿é—® http://43.99.101.195
3. æµ‹è¯•åŠŸèƒ½å…«æ–°åŠŸèƒ½

---

## ğŸ” éªŒè¯å‘½ä»¤

### æŸ¥çœ‹æœåŠ¡çŠ¶æ€
```bash
ssh root@43.99.101.195 "systemctl status gunicorn | grep Active"
```

### æŸ¥çœ‹ç«¯å£ç›‘å¬
```bash
ssh root@43.99.101.195 "netstat -tlnp | grep 5000"
```

### æŸ¥çœ‹æœ€æ–°æäº¤
```bash
ssh root@43.99.101.195 "cd /www/wwwroot/patent-workbench && git log --oneline -1"
```

### æŸ¥çœ‹é…ç½®
```bash
ssh root@43.99.101.195 "cd /www/wwwroot/patent-workbench && cat gunicorn_config.py | grep bind"
```

### æŸ¥çœ‹å®æ—¶æ—¥å¿—
```bash
ssh root@43.99.101.195 "journalctl -u gunicorn -f"
```

---

## ğŸ†˜ å¸¸è§é—®é¢˜

### Q1: SSHè¿æ¥å¤±è´¥ï¼Ÿ
```bash
# æ£€æŸ¥SSHå¯†é’¥
ssh-keygen -t rsa
ssh-copy-id root@43.99.101.195

# æˆ–ä½¿ç”¨å¯†ç ç™»å½•
ssh root@43.99.101.195
```

### Q2: git pull å¤±è´¥ï¼Ÿ
```bash
# æŸ¥çœ‹çŠ¶æ€
ssh root@43.99.101.195 "cd /www/wwwroot/patent-workbench && git status"

# æš‚å­˜æœ¬åœ°ä¿®æ”¹
ssh root@43.99.101.195 "cd /www/wwwroot/patent-workbench && git stash && git pull && git stash pop"
```

### Q3: æœåŠ¡é‡å¯å¤±è´¥ï¼Ÿ
```bash
# æŸ¥çœ‹æ—¥å¿—
ssh root@43.99.101.195 "journalctl -u gunicorn -n 50"

# æ£€æŸ¥ç«¯å£å ç”¨
ssh root@43.99.101.195 "lsof -i :5000"
```

### Q4: é…ç½®è¢«è¦†ç›–ï¼Ÿ
```bash
# ä¿®å¤é…ç½®
ssh root@43.99.101.195 "cd /www/wwwroot/patent-workbench && sed -i 's/127.0.0.1:5000/0.0.0.0:5000/g' gunicorn_config.py && systemctl restart gunicorn"
```

---

## ğŸ”„ å›æ»šå‘½ä»¤

å¦‚æœæ›´æ–°åå‡ºç°é—®é¢˜ï¼š

```bash
# å›æ»šåˆ°ä¸Šä¸€ç‰ˆæœ¬
ssh root@43.99.101.195 "cd /www/wwwroot/patent-workbench && git reset --hard HEAD^ && systemctl restart gunicorn"
```

---

## ğŸ“Š å‘½ä»¤å¯¹æ¯”è¡¨

| æ“ä½œ | æ—§å‘½ä»¤ | æ–°å‘½ä»¤ | çŠ¶æ€ |
|------|--------|--------|------|
| ç”¨æˆ·åˆ‡æ¢ | su - appuser | ç›´æ¥ç”¨root | âœ… ç®€åŒ– |
| é¡¹ç›®è·¯å¾„ | ~/patent-app | /www/wwwroot/patent-workbench | âœ… æ­£ç¡® |
| æ‹‰å–ä»£ç  | git pull | git pull + é…ç½®æ£€æŸ¥ | âœ… å¢å¼º |
| é‡å¯æœåŠ¡ | patent-app | gunicorn | âœ… æ­£ç¡® |
| é…ç½®ä¿æŠ¤ | æ—  | è‡ªåŠ¨ä¿®å¤é…ç½® | âœ… æ–°å¢ |
| çŠ¶æ€éªŒè¯ | æ—  | è‡ªåŠ¨éªŒè¯ | âœ… æ–°å¢ |

---

## ğŸ¯ æ¨èä½¿ç”¨

**æœ€æ¨èï¼š** ä½¿ç”¨ `è¿œç¨‹æ›´æ–°é˜¿é‡Œäº‘.bat` æ‰¹å¤„ç†è„šæœ¬

**ä¼˜ç‚¹ï¼š**
- âœ… è‡ªåŠ¨åŒ–ç¨‹åº¦é«˜
- âœ… æœ‰è¯¦ç»†æç¤º
- âœ… è‡ªåŠ¨æ£€æŸ¥å’Œä¿®å¤
- âœ… è‡ªåŠ¨éªŒè¯ç»“æœ
- âœ… å‡ºé”™æœ‰æç¤º

**ä½¿ç”¨æ–¹æ³•ï¼š**
1. åŒå‡» `è¿œç¨‹æ›´æ–°é˜¿é‡Œäº‘.bat`
2. ç­‰å¾…è‡ªåŠ¨å®Œæˆ
3. æŸ¥çœ‹éªŒè¯ç»“æœ
4. æµ‹è¯•ç½‘ç«™åŠŸèƒ½

---

**æ›´æ–°æ—¶é—´**ï¼š2026-01-31  
**æœåŠ¡å™¨IP**ï¼š43.99.101.195  
**é¡¹ç›®è·¯å¾„**ï¼š/www/wwwroot/patent-workbench  
**æœåŠ¡åç§°**ï¼šgunicorn
