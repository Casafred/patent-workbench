# 功能七多语言支持 - 快速测试指南

## 🚀 快速测试（3分钟）

### 步骤1：清除缓存
```
按 Ctrl + Shift + Delete
选择"缓存的图片和文件"
时间范围：全部时间
点击"清除数据"
```

### 步骤2：强制刷新
```
按 Ctrl + F5（强制刷新）
```

### 步骤3：配置API Key（如果未配置）
```
1. 点击页面右上角的设置图标 ⚙️
2. 输入智谱AI的API Key
3. 点击保存
```

### 步骤4：测试法文文本
```
1. 打开功能七 - 文本分析
2. 输入以下法文文本：

Revendication 1. Un dispositif comprenant un processeur.

3. 点击"开始分析"
4. 应该弹出对话框："检测到法语文本"
5. 检查取消按钮是否清晰可见（灰色背景）
6. 点击"开启AI模式"
7. 等待AI翻译完成
8. 查看分析结果
```

---

## ✅ 预期结果

### 1. 语言检测
- ✅ 法文文本被正确识别为"法语"
- ✅ 弹出对话框提示"检测到法语文本"

### 2. 对话框样式
- ✅ 取消按钮清晰可见（灰色背景 + 深色文字）
- ✅ 确认按钮为蓝色背景 + 白色文字

### 3. AI翻译
- ✅ 点击"开启AI模式"后显示"正在使用AI翻译并分析..."
- ✅ 翻译完成后显示"✓ AI翻译完成（fr → 中文），成功识别 X 条权利要求"
- ✅ 显示独从权分析结果

---

## 🧪 完整测试用例

### 测试1：法文文本
```
输入：
Revendication 1. Un dispositif comprenant un processeur.
Revendication 2. Le dispositif selon la revendication 1.

预期：
- 检测为法语 ✅
- 弹出AI模式提示 ✅
- 翻译后识别出2条权利要求 ✅
- 权利要求1为独立权利要求 ✅
- 权利要求2为从属权利要求，引用权利要求1 ✅
```

### 测试2：德文文本
```
输入：
Anspruch 1. Eine Vorrichtung mit einem Prozessor.
Anspruch 2. Die Vorrichtung nach Anspruch 1.

预期：
- 检测为德语 ✅
- 弹出AI模式提示 ✅
- 翻译后识别出2条权利要求 ✅
```

### 测试3：中文文本（直接解析）
```
输入：
权利要求1. 一种包括处理器的装置。
权利要求2. 根据权利要求1所述的装置。

预期：
- 检测为中文 ✅
- 不弹出对话框 ✅
- 直接解析，识别出2条权利要求 ✅
```

### 测试4：英文文本（直接解析）
```
输入：
Claim 1. A device comprising a processor.
Claim 2. The device of claim 1.

预期：
- 检测为英文 ✅
- 不弹出对话框 ✅
- 直接解析，识别出2条权利要求 ✅
```

---

## 🔍 控制台调试

打开浏览器控制台（F12 → Console），运行以下命令：

### 检查函数是否加载
```javascript
console.log('detectTextLanguage:', typeof detectTextLanguage);
// 应该返回: "function"

console.log('analyzeClaimsText:', analyzeClaimsText.constructor.name);
// 应该返回: "AsyncFunction"
```

### 测试语言检测
```javascript
// 法文
console.log('法文:', detectTextLanguage("Revendication 1. Un dispositif"));
// 应该返回: "fr"

// 德文
console.log('德文:', detectTextLanguage("Anspruch 1. Eine Vorrichtung"));
// 应该返回: "de"

// 中文
console.log('中文:', detectTextLanguage("权利要求1. 一种装置"));
// 应该返回: "zh"

// 英文
console.log('英文:', detectTextLanguage("Claim 1. A device"));
// 应该返回: "en"
```

### 检查API Key配置
```javascript
console.log('API Key:', window.state?.apiKey ? '已配置 ✅' : '未配置 ❌');
```

---

## ❌ 常见问题

### Q1: 仍然直接显示结果，不弹出对话框
**原因**：浏览器缓存未清除
**解决**：
1. 按 Ctrl + Shift + Delete 清除缓存
2. 按 Ctrl + F5 强制刷新
3. 或使用无痕模式测试（Ctrl + Shift + N）

### Q2: 取消按钮看不清
**原因**：浏览器缓存了旧样式
**解决**：清除缓存并刷新

### Q3: 点击"开启AI模式"后报错"请先在设置中配置API Key"
**原因**：API Key未配置
**解决**：
1. 点击页面右上角的设置图标 ⚙️
2. 输入智谱AI的API Key
3. 保存后重试

### Q4: 点击"开启AI模式"后报错"Authorization header with Bearer token is required"
**原因**：前端没有发送API Key（浏览器缓存问题）
**解决**：
1. 清除浏览器缓存
2. 强制刷新页面
3. 在控制台检查：`console.log(window.state?.apiKey)`

---

## 📊 测试检查清单

- [ ] 清除浏览器缓存
- [ ] 强制刷新页面（Ctrl + F5）
- [ ] 配置API Key
- [ ] 测试法文文本 - 弹出对话框
- [ ] 测试德文文本 - 弹出对话框
- [ ] 测试中文文本 - 直接解析
- [ ] 测试英文文本 - 直接解析
- [ ] 取消按钮清晰可见
- [ ] AI翻译功能正常工作
- [ ] 独从权分析结果正确

---

## 🎯 成功标准

### 必须满足
1. ✅ 法文/德文文本触发AI模式提示
2. ✅ 取消按钮清晰可见
3. ✅ AI翻译功能正常工作
4. ✅ 独从权分析结果正确

### 可选验证
1. ✅ 日文/韩文文本也能触发AI模式
2. ✅ 混合语言文本能正确识别主要语言
3. ✅ 错误提示友好清晰

---

## 📞 获取帮助

如果测试失败，请提供以下信息：

1. **浏览器控制台截图**（F12 → Console）
2. **Network标签截图**（F12 → Network）
3. **测试结果**：
   ```javascript
   console.log('detectTextLanguage:', typeof detectTextLanguage);
   console.log('测试法文:', detectTextLanguage("Revendication 1"));
   console.log('API Key:', window.state?.apiKey ? '已配置' : '未配置');
   ```

---

**测试时间**：约3-5分钟  
**难度**：简单  
**前置条件**：已配置API Key
