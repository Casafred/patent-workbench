# åŠŸèƒ½å…«UIä¼˜åŒ–å®Œæˆ v4.0 âœ…

## ğŸ“‹ ä¼˜åŒ–å†…å®¹

### 1. é«˜æ¸…å›¾ç‰‡æ˜¾ç¤º ğŸ¯
**é—®é¢˜**: è¯†åˆ«åçš„å›¾ç‰‡å˜ç³Šäº†
**è§£å†³**: 
- Canvasä½¿ç”¨åŸå§‹å›¾ç‰‡å°ºå¯¸ï¼ˆä¸ç¼©å°ï¼‰
- è®¾ç½® `canvas.style.maxWidth = '100%'` å’Œ `height = 'auto'` è‡ªé€‚åº”å®¹å™¨
- ç§»é™¤äº†ä¹‹å‰çš„ç¼©æ”¾é€»è¾‘ï¼Œç›´æ¥æ˜¾ç¤ºé«˜æ¸…åŸå›¾

### 2. ç§»é™¤çº¢ç‚¹æ ‡è¯† â­•
**é—®é¢˜**: çº¢ç‚¹ä¼šæŠŠåŸå›¾ä¸Šçš„æ ‡è®°æŒ¡ä½
**è§£å†³**:
- å®Œå…¨ç§»é™¤çº¢ç‚¹ç»˜åˆ¶ä»£ç 
- åªä¿ç•™çº¿æ¡è¿æ¥ï¼ˆä»åŸå§‹æ ‡è®°ä½ç½®åˆ°æ ‡æ³¨æ–‡å­—ï¼‰
- çº¿æ¡ä½¿ç”¨é†’ç›®çš„æ©™çº¢è‰² `#FF5722`

### 3. çº¯æ–‡æœ¬æ ‡æ³¨ï¼ˆæ— èƒŒæ™¯æ¡†ï¼‰ğŸ“
**é—®é¢˜**: ä¸éœ€è¦å¸¦èƒŒæ™¯é¢œè‰²çš„æ ‡æ³¨æ¡†
**è§£å†³**:
- ç§»é™¤æ‰€æœ‰èƒŒæ™¯æ¡†ç»˜åˆ¶ä»£ç 
- ä½¿ç”¨çº¯æ–‡æœ¬ + ç™½è‰²æè¾¹å¢å¼ºå¯è¯»æ€§
- æ–‡å­—é¢œè‰²æ”¹ä¸ºé†’ç›®çš„æ©™çº¢è‰² `#FF5722`
- å­—ä½“åŠ ç²—ï¼Œæ›´æ¸…æ™°

### 4. ä¸“ä¸šå¼¹çª—æŸ¥çœ‹å™¨ ğŸ–¼ï¸
**é—®é¢˜**: å¼¹çª—UIä¸å¯¹ï¼Œé™æ€çš„ï¼Œæ— æ³•ç¼©æ”¾å’Œæ‹–åŠ¨
**è§£å†³**:
- âœ… å¤§å¼¹çª—ï¼ˆ90%å®½åº¦ï¼Œ85%é«˜åº¦ï¼‰
- âœ… é¼ æ ‡æ»šè½®ç¼©æ”¾ï¼ˆ50%-500%ï¼‰
- âœ… æ‹–åŠ¨å›¾ç‰‡æŸ¥çœ‹ä¸åŒä½ç½®
- âœ… å·¥å…·æ ï¼šç¼©æ”¾æ˜¾ç¤ºã€æ”¾å¤§ã€ç¼©å°ã€é‡ç½®ã€å…³é—­
- âœ… ç‚¹å‡»èƒŒæ™¯æˆ–æŒ‰ESCå…³é—­
- âœ… æ‹–åŠ¨æ—¶å…‰æ ‡å˜åŒ–ï¼ˆgrab/grabbingï¼‰

## ğŸ¨ è§†è§‰æ•ˆæœ

### ä¸»ç•Œé¢
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                 â”‚
â”‚     [é«˜æ¸…åŸå›¾]                  â”‚
â”‚                                 â”‚
â”‚   1 â”€â”€â”€â”€â”€â”€â†’ 1: åº•åº§             â”‚
â”‚                                 â”‚
â”‚        2 â”€â”€â†’ 2: ç«‹æŸ±            â”‚
â”‚                                 â”‚
â”‚   (æ— çº¢ç‚¹ï¼Œåªæœ‰çº¿æ¡+æ–‡å­—)       â”‚
â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å¼¹çª—ç•Œé¢
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [100%] [-] [é‡ç½®] [+] [å…³é—­Ã—]          â”‚
â”‚                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                    â”‚ â”‚
â”‚  â”‚    [å¯ç¼©æ”¾ã€å¯æ‹–åŠ¨çš„é«˜æ¸…å›¾ç‰‡]     â”‚ â”‚
â”‚  â”‚                                    â”‚ â”‚
â”‚  â”‚    1 â”€â”€â”€â”€â”€â”€â†’ 1: åº•åº§               â”‚ â”‚
â”‚  â”‚                                    â”‚ â”‚
â”‚  â”‚         2 â”€â”€â†’ 2: ç«‹æŸ±              â”‚ â”‚
â”‚  â”‚                                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”§ æŠ€æœ¯å®ç°

### é«˜æ¸…æ˜¾ç¤º
```javascript
// è®¾ç½®Canvaså°ºå¯¸ä¸ºåŸå§‹å°ºå¯¸
this.canvas.width = this.originalWidth;
this.canvas.height = this.originalHeight;

// è®¾ç½®æ˜¾ç¤ºå°ºå¯¸ï¼ˆä½¿ç”¨åŸå§‹å°ºå¯¸ï¼Œä¸ç¼©å°ï¼‰
this.canvas.style.width = `${this.originalWidth}px`;
this.canvas.style.height = `${this.originalHeight}px`;

// è‡ªé€‚åº”å®¹å™¨
this.canvas.style.maxWidth = '100%';
this.canvas.style.height = 'auto';
```

### çº¯çº¿æ¡æ ‡æ³¨
```javascript
// åªç»˜åˆ¶çº¿æ¡ï¼ˆæ— çº¢ç‚¹ï¼‰
ctx.beginPath();
ctx.moveTo(annotation.markerX, annotation.markerY);
ctx.lineTo(annotation.labelX, annotation.labelY);
ctx.strokeStyle = '#FF5722';  // æ©™çº¢è‰²
ctx.lineWidth = 2;
ctx.stroke();

// çº¯æ–‡æœ¬ï¼ˆæ— èƒŒæ™¯æ¡†ï¼‰
ctx.font = 'bold 18px Arial, sans-serif';
ctx.strokeStyle = '#FFFFFF';  // ç™½è‰²æè¾¹
ctx.lineWidth = 4;
ctx.strokeText(text, x, y);
ctx.fillStyle = '#FF5722';  // æ©™çº¢è‰²æ–‡å­—
ctx.fillText(text, x, y);
```

### å¼¹çª—ç¼©æ”¾
```javascript
// é¼ æ ‡æ»šè½®ç¼©æ”¾
container.addEventListener('wheel', (e) => {
    e.preventDefault();
    const delta = e.deltaY > 0 ? -zoomStep : zoomStep;
    currentZoom = Math.max(minZoom, Math.min(maxZoom, currentZoom + delta));
    updateCanvasSize();
    zoomDisplay.textContent = `${Math.round(currentZoom * 100)}%`;
}, { passive: false });
```

### æ‹–åŠ¨å¹³ç§»
```javascript
// æ‹–åŠ¨å›¾ç‰‡
container.addEventListener('mousedown', (e) => {
    isDragging = true;
    container.style.cursor = 'grabbing';
    startX = e.pageX - container.offsetLeft;
    startY = e.pageY - container.offsetTop;
    scrollLeft = container.scrollLeft;
    scrollTop = container.scrollTop;
});

container.addEventListener('mousemove', (e) => {
    if (!isDragging) return;
    e.preventDefault();
    const x = e.pageX - container.offsetLeft;
    const y = e.pageY - container.offsetTop;
    const walkX = (x - startX) * 1.5;
    const walkY = (y - startY) * 1.5;
    container.scrollLeft = scrollLeft - walkX;
    container.scrollTop = scrollTop - walkY;
});
```

## ğŸ“¦ ä¿®æ”¹çš„æ–‡ä»¶

1. **frontend/js/drawingMarkerInteractive.js**
   - `setupCanvas()` - ä¿®æ”¹ä¸ºä½¿ç”¨åŸå§‹å°ºå¯¸
   - `drawAnnotation()` - ç§»é™¤çº¢ç‚¹ï¼Œæ”¹ä¸ºçº¯çº¿æ¡+æ–‡å­—
   - `createModal()` - ä¼˜åŒ–å¼¹çª—UIå’Œäº¤äº’

## ğŸ§ª æµ‹è¯•æ–¹æ³•

### æœ¬åœ°æµ‹è¯•
```bash
# æ‰“å¼€æµ‹è¯•é¡µé¢
test_interactive_marker_v4.html
```

### æµ‹è¯•è¦ç‚¹
- [ ] ä¸»ç•Œé¢å›¾ç‰‡æ¸…æ™°ï¼ˆä¸æ¨¡ç³Šï¼‰
- [ ] æ²¡æœ‰çº¢ç‚¹ï¼Œåªæœ‰çº¿æ¡è¿æ¥
- [ ] æ ‡æ³¨æ–‡å­—æ— èƒŒæ™¯æ¡†ï¼Œé¢œè‰²é†’ç›®
- [ ] ç‚¹å‡»å›¾ç‰‡æ‰“å¼€å¤§å¼¹çª—
- [ ] å¼¹çª—ä¸­å¯ä»¥ç”¨é¼ æ ‡æ»šè½®ç¼©æ”¾
- [ ] å¼¹çª—ä¸­å¯ä»¥æ‹–åŠ¨å›¾ç‰‡æŸ¥çœ‹
- [ ] å·¥å…·æ æŒ‰é’®æ­£å¸¸å·¥ä½œ
- [ ] ç‚¹å‡»èƒŒæ™¯æˆ–ESCå¯ä»¥å…³é—­

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### 1. æäº¤åˆ°Git
```bash
git add frontend/js/drawingMarkerInteractive.js
git add test_interactive_marker_v4.html
git add åŠŸèƒ½å…«UIä¼˜åŒ–å®Œæˆv4.md
git commit -m "åŠŸèƒ½å…«UIä¼˜åŒ–v4: é«˜æ¸…æ˜¾ç¤º+çº¯çº¿æ¡æ ‡æ³¨+ä¸“ä¸šå¼¹çª—"
git push origin main
```

### 2. éƒ¨ç½²åˆ°æœåŠ¡å™¨
```bash
# æ–¹æ³•1: ä¸€é”®éƒ¨ç½²
ssh root@43.99.101.195 "su - appuser -c 'cd ~/patent-app && git pull origin main' && systemctl restart patent-app"

# æ–¹æ³•2: åˆ†æ­¥éƒ¨ç½²
ssh root@43.99.101.195
su - appuser
cd ~/patent-app
git pull origin main
exit
systemctl restart patent-app
```

### 3. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜
- æŒ‰ `Ctrl + Shift + Delete`
- é€‰æ‹©"ç¼“å­˜çš„å›¾ç‰‡å’Œæ–‡ä»¶"
- ç‚¹å‡»"æ¸…é™¤æ•°æ®"
- æˆ–è€…æŒ‰ `Ctrl + F5` å¼ºåˆ¶åˆ·æ–°

### 4. éªŒè¯åŠŸèƒ½
1. è®¿é—® http://43.99.101.195
2. è¿›å…¥åŠŸèƒ½å…«
3. ä¸Šä¼ ä¸“åˆ©é™„å›¾
4. è¾“å…¥è¯´æ˜ä¹¦
5. ç‚¹å‡»è¯†åˆ«
6. æ£€æŸ¥ï¼š
   - å›¾ç‰‡æ˜¯å¦æ¸…æ™°
   - æ˜¯å¦æ²¡æœ‰çº¢ç‚¹
   - æ ‡æ³¨æ˜¯å¦ä¸ºçº¯æ–‡å­—+çº¿æ¡
   - ç‚¹å‡»å›¾ç‰‡æ˜¯å¦æ‰“å¼€å¤§å¼¹çª—
   - å¼¹çª—æ˜¯å¦å¯ä»¥ç¼©æ”¾å’Œæ‹–åŠ¨

## ğŸ“Š å¯¹æ¯”

### ä¼˜åŒ–å‰
- âŒ å›¾ç‰‡æ¨¡ç³Šï¼ˆè¢«ç¼©å°ï¼‰
- âŒ æœ‰çº¢ç‚¹é®æŒ¡åŸå§‹æ ‡è®°
- âŒ æ ‡æ³¨æœ‰èƒŒæ™¯æ¡†
- âŒ å¼¹çª—é™æ€ï¼Œæ— æ³•ç¼©æ”¾å’Œæ‹–åŠ¨

### ä¼˜åŒ–å
- âœ… å›¾ç‰‡é«˜æ¸…ï¼ˆåŸå§‹å°ºå¯¸ï¼‰
- âœ… æ— çº¢ç‚¹ï¼Œåªæœ‰çº¿æ¡
- âœ… çº¯æ–‡å­—æ ‡æ³¨ï¼Œé†’ç›®æ¸…æ™°
- âœ… ä¸“ä¸šå¼¹çª—ï¼Œå¯ç¼©æ”¾å¯æ‹–åŠ¨

## ğŸ¯ ç”¨æˆ·ä½“éªŒæå‡

1. **å›¾ç‰‡æ¸…æ™°åº¦**: â­â­â­â­â­
   - ä½¿ç”¨åŸå§‹å°ºå¯¸ï¼Œå®Œå…¨é«˜æ¸…

2. **æ ‡æ³¨å¯è§æ€§**: â­â­â­â­â­
   - ç§»é™¤çº¢ç‚¹ï¼Œä¸é®æŒ¡åŸå›¾
   - æ©™çº¢è‰²çº¿æ¡å’Œæ–‡å­—ï¼Œé†’ç›®æ˜“è¯†åˆ«

3. **æŸ¥çœ‹ä¾¿åˆ©æ€§**: â­â­â­â­â­
   - å¤§å¼¹çª— + ç¼©æ”¾ + æ‹–åŠ¨
   - ç±»ä¼¼ä¸“ä¸šå›¾ç‰‡æŸ¥çœ‹å™¨

4. **æ“ä½œæµç•…åº¦**: â­â­â­â­â­
   - é¼ æ ‡æ»šè½®ç¼©æ”¾
   - æ‹–åŠ¨å¹³ç§»
   - å¿«æ·é”®æ”¯æŒ

## ğŸ’¡ åç»­ä¼˜åŒ–å»ºè®®

1. **æ ‡æ³¨ç¼–è¾‘**
   - åŒå‡»æ ‡æ³¨æ–‡å­—å¯ä»¥ç¼–è¾‘
   - æ‹–åŠ¨æ ‡æ³¨ä½ç½®è°ƒæ•´

2. **å¯¼å‡ºåŠŸèƒ½**
   - å¯¼å‡ºé«˜æ¸…æ ‡æ³¨å›¾ç‰‡
   - å¯¼å‡ºæ ‡æ³¨æ•°æ®JSON

3. **å¿«æ·é”®**
   - `+/-` é”®ç¼©æ”¾
   - æ–¹å‘é”®å¹³ç§»
   - `Space` é”®é‡ç½®

4. **è§¦æ‘¸æ”¯æŒ**
   - åŒæŒ‡ç¼©æ”¾
   - å•æŒ‡æ‹–åŠ¨
   - ç§»åŠ¨ç«¯ä¼˜åŒ–

---

**ä¼˜åŒ–å®Œæˆæ—¶é—´**: 2026-01-31
**ç‰ˆæœ¬**: v4.0
**çŠ¶æ€**: âœ… å·²å®Œæˆï¼Œå¾…æµ‹è¯•éƒ¨ç½²
