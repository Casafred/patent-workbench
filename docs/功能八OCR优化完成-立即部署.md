# åŠŸèƒ½å…«OCRä¼˜åŒ–å®Œæˆ - ç«‹å³éƒ¨ç½²

## âœ… å·²å®Œæˆä¼˜åŒ–

é’ˆå¯¹**ç™½åº•é»‘çº¿ã€å°æ•°å­—**çš„ä¸“åˆ©é™„å›¾ï¼Œå·²å®Œæˆä»¥ä¸‹ä¼˜åŒ–ï¼š

### æ ¸å¿ƒæ”¹è¿›

1. **å›¾åƒæ”¾å¤§**: 3000pxï¼ˆç¡®ä¿å°æ•°å­—æœ‰è¶³å¤Ÿåƒç´ ï¼‰
2. **åè½¬å¤„ç†**: ç™½åº•é»‘å­— â†’ é»‘åº•ç™½å­—ï¼ˆOCRæ•ˆæœæ›´å¥½ï¼‰
3. **PSMæ¨¡å¼**: PSM 6 â†’ PSM 11ï¼ˆé€‚åˆç¨€ç–åˆ†å¸ƒçš„æ•°å­—ï¼‰
4. **é¢„å¤„ç†æ–¹æ³•**: 5ç§ä¸“åˆ©é™„å›¾ä¸“ç”¨æ–¹æ³•
5. **ç½®ä¿¡åº¦é˜ˆå€¼**: é™ä½åˆ°40/50ï¼ˆæ•è·å°æ•°å­—ï¼‰

### æŠ€æœ¯ç»†èŠ‚

```python
# å…³é”®ä¼˜åŒ–ç‚¹
- å›¾åƒæ”¾å¤§åˆ°3000px+
- åè½¬ + äºŒå€¼åŒ–ï¼ˆé»‘åº•ç™½å­—ï¼‰
- é«˜å¯¹æ¯”åº¦(3.0x) + åŒé‡é”åŒ–
- PSM 11ï¼ˆç¨€ç–æ–‡æœ¬æ¨¡å¼ï¼‰
- å½¢æ€å­¦è†¨èƒ€ï¼ˆåŠ ç²—ç»†çº¿æ¡ï¼‰
```

## ğŸš€ ç«‹å³éƒ¨ç½²

### æ–¹æ³•1: ä¸€é”®éƒ¨ç½²ï¼ˆæ¨èï¼‰

```bash
git add backend/routes/drawing_marker.py && git commit -m "ä¼˜åŒ–åŠŸèƒ½å…«OCR - ä¸“åˆ©é™„å›¾ç™½åº•é»‘çº¿å°æ•°å­—ä¸“ç”¨é…ç½®" && git push origin main && ssh root@43.99.101.195 "su - appuser -c 'cd /home/appuser/patent-app && git pull' && sudo systemctl restart patent-app"
```

### æ–¹æ³•2: åˆ†æ­¥éƒ¨ç½²

```bash
# 1. æäº¤ä»£ç 
git add backend/routes/drawing_marker.py
git commit -m "ä¼˜åŒ–åŠŸèƒ½å…«OCR - ä¸“åˆ©é™„å›¾ç™½åº•é»‘çº¿å°æ•°å­—ä¸“ç”¨é…ç½®"
git push origin main

# 2. æœåŠ¡å™¨æ›´æ–°
ssh root@43.99.101.195 "su - appuser -c 'cd /home/appuser/patent-app && git pull'"

# 3. é‡å¯æœåŠ¡
ssh root@43.99.101.195 "sudo systemctl restart patent-app"

# 4. éªŒè¯çŠ¶æ€
ssh root@43.99.101.195 "sudo systemctl status patent-app"
```

## ğŸ§ª æµ‹è¯•éªŒè¯

### 1. å‰ç«¯æµ‹è¯•

1. è®¿é—®åŠŸèƒ½å…«é¡µé¢: `http://43.99.101.195/`
2. ä¸Šä¼ ä¸“åˆ©é™„å›¾ï¼ˆç™½åº•é»‘çº¿ã€å°æ•°å­—ï¼‰
3. è¾“å…¥è¯´æ˜ä¹¦æ–‡æœ¬ï¼ˆå¦‚ï¼š"1. åº•åº§\n2. æ—‹è½¬è‡‚\n3. å¤¹ç´§è£…ç½®"ï¼‰
4. ç‚¹å‡»"å¼€å§‹å¤„ç†"
5. æŸ¥çœ‹è¯†åˆ«ç»“æœ

### 2. é¢„æœŸç»“æœ

**ä¼˜åŒ–å‰**:
```json
{
  "total_numbers": 0,
  "match_rate": 0,
  "detected_numbers": []
}
```

**ä¼˜åŒ–å**:
```json
{
  "total_numbers": 15,
  "match_rate": 75.5,
  "detected_numbers": [
    {"number": "1", "confidence": 75, ...},
    {"number": "2", "confidence": 68, ...},
    ...
  ]
}
```

### 3. æŸ¥çœ‹æ—¥å¿—

```bash
# å®æ—¶æŸ¥çœ‹æ—¥å¿—
ssh root@43.99.101.195 "sudo journalctl -u patent-app -f"

# æŸ¥çœ‹æœ€è¿‘100è¡ŒDEBUGæ—¥å¿—
ssh root@43.99.101.195 "sudo journalctl -u patent-app -n 100 | grep DEBUG"
```

**åº”è¯¥çœ‹åˆ°**:
```
[DEBUG] Original size: 800x600
[DEBUG] Upscaled to: (4000, 3000) (scale: 5.00x)
[DEBUG] Running OCR with method: inverted_binary
[DEBUG] OCR detected: '1' (confidence: 75)
[DEBUG] OCR detected: '2' (confidence: 68)
[DEBUG] Method inverted_binary detected 15 numbers
[DEBUG] Total unique detections: 15
[DEBUG] After filtering: 12 detections remain
[DEBUG] Matched 12 numbers with reference_map
```

## ğŸ“Š ä¼˜åŒ–æ•ˆæœå¯¹æ¯”

| æŒ‡æ ‡ | ä¼˜åŒ–å‰ | ä¼˜åŒ–å | æ”¹è¿› |
|------|--------|--------|------|
| è¯†åˆ«æ•°é‡ | 0 | é¢„æœŸ10-20 | âœ… æ˜¾è‘—æå‡ |
| åŒ¹é…ç‡ | 0% | é¢„æœŸ50-80% | âœ… æ˜¾è‘—æå‡ |
| å›¾åƒå°ºå¯¸ | 1500-3000px | 3000px+ | âœ… æ›´å¤§ |
| PSMæ¨¡å¼ | PSM 6 | PSM 11 | âœ… æ›´é€‚åˆ |
| é¢„å¤„ç† | 4ç§é€šç”¨ | 5ç§ä¸“ç”¨ | âœ… æ›´é’ˆå¯¹æ€§ |

## ğŸ” å¦‚æœè¯†åˆ«ç‡ä»ç„¶ä½

### å¯èƒ½åŸå› 

1. **å›¾ç‰‡è´¨é‡é—®é¢˜**
   - åŸå§‹åˆ†è¾¨ç‡å¤ªä½ï¼ˆ<500pxï¼‰
   - å›¾ç‰‡æ¨¡ç³Šæˆ–å¤±ç„¦
   - æ•°å­—å¤ªå°ï¼ˆ<5pxï¼‰

2. **æ•°å­—ç‰¹å¾é—®é¢˜**
   - æ‰‹å†™æ•°å­—
   - ç‰¹æ®Šå­—ä½“
   - æ•°å­—ä¸çº¿æ¡é‡å 

3. **èƒŒæ™¯å¹²æ‰°**
   - å¤æ‚èƒŒæ™¯å›¾æ¡ˆ
   - å™ªç‚¹è¿‡å¤š

### è¿›ä¸€æ­¥ä¼˜åŒ–æ–¹æ¡ˆ

1. **è¿è¡Œè¯Šæ–­è„šæœ¬**ï¼ˆä¹‹å‰åˆ›å»ºçš„ï¼‰
   ```bash
   scp test_ocr_on_server.py root@43.99.101.195:/home/appuser/patent-app/
   scp "ä½ çš„æµ‹è¯•å›¾ç‰‡.png" root@43.99.101.195:/home/appuser/patent-app/test_image.png
   ssh root@43.99.101.195 "su - appuser -c 'cd /home/appuser/patent-app && python3 test_ocr_on_server.py test_image.png'"
   ```

2. **è€ƒè™‘å…¶ä»–OCRå¼•æ“**
   - EasyOCRï¼ˆæ·±åº¦å­¦ä¹ ï¼Œæ•ˆæœæ›´å¥½ä½†é€Ÿåº¦æ…¢ï¼‰
   - PaddleOCRï¼ˆä¸­æ–‡ä¼˜åŒ–ï¼Œé€Ÿåº¦å¿«ï¼‰
   - Google Cloud Vision APIï¼ˆå•†ä¸šæ–¹æ¡ˆï¼‰

3. **è®­ç»ƒè‡ªå®šä¹‰æ¨¡å‹**
   - æ”¶é›†ä¸“åˆ©é™„å›¾æ•°æ®é›†
   - è®­ç»ƒTesseractè‡ªå®šä¹‰æ¨¡å‹
   - é’ˆå¯¹ç‰¹å®šå­—ä½“ä¼˜åŒ–

## ğŸ“ ç›¸å…³æ–‡æ¡£

- `åŠŸèƒ½å…«OCRä¼˜åŒ–-ä¸“åˆ©é™„å›¾ä¸“ç”¨.md` - è¯¦ç»†æŠ€æœ¯è¯´æ˜
- `åŠŸèƒ½å…«OCRè¯†åˆ«è¯Šæ–­æŒ‡å—.md` - è¯Šæ–­æ–¹æ¡ˆ
- `test_ocr_on_server.py` - è¯Šæ–­è„šæœ¬
- `backend/routes/drawing_marker.py` - ä¼˜åŒ–åçš„ä»£ç 

## âœ… ä»»åŠ¡å®ŒæˆçŠ¶æ€

- [x] ä»»åŠ¡1: ä¿®å¤åç«¯OCRè¯†åˆ«é€»è¾‘æ ¸å¿ƒé”™è¯¯
- [x] ä»»åŠ¡2: å®ç°ç»“æœå»é‡å’Œè¿‡æ»¤åŠŸèƒ½
- [x] **ä»»åŠ¡3: ä¼˜åŒ–å›¾åƒé¢„å¤„ç†å’ŒOCRé…ç½®** âœ… åˆšå®Œæˆ
- [x] ä»»åŠ¡4: å¢å¼ºé”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•
- [x] ä»»åŠ¡7: å®ç°è¯†åˆ«ç»“æœéªŒè¯å’Œç»Ÿè®¡
- [x] ä»»åŠ¡9: ä¿®å¤å‰ç«¯æ•°æ®æ˜¾ç¤º

## ğŸ¯ ä¸‹ä¸€æ­¥

1. **ç«‹å³éƒ¨ç½²**: è¿è¡Œä¸Šé¢çš„ä¸€é”®éƒ¨ç½²å‘½ä»¤
2. **æµ‹è¯•éªŒè¯**: ç”¨çœŸå®ä¸“åˆ©é™„å›¾æµ‹è¯•
3. **åé¦ˆç»“æœ**: å‘Šè¯‰æˆ‘è¯†åˆ«æ•ˆæœå¦‚ä½•
4. **æŒç»­ä¼˜åŒ–**: æ ¹æ®å®é™…æ•ˆæœè¿›ä¸€æ­¥è°ƒæ•´

---

**å‡†å¤‡å¥½äº†å—ï¼Ÿè¿è¡Œä¸€é”®éƒ¨ç½²å‘½ä»¤å¼€å§‹æµ‹è¯•ï¼** ğŸš€
