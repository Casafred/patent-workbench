# 联网搜索功能说明

## 功能概述

即时对话模块现已集成智谱AI网络搜索功能，可以让AI助手实时获取最新的网络信息，并结合搜索结果生成更准确、更及时的回答。

## 功能特点

### 1. 智能搜索集成
- **自动触发**：AI会根据问题内容自动判断是否需要进行网络搜索
- **实时信息**：获取最新的网络资讯、数据和知识
- **来源标注**：搜索结果会自动标注来源链接，确保信息可追溯

### 2. 多引擎支持
系统支持多种搜索引擎，满足不同场景需求：

| 搜索引擎 | 价格 | 特点 | 适用场景 |
|---------|------|------|---------|
| **智谱基础版** | 0.01元/次 | 性价比极高，满足日常查询需求 | 一般性问题查询 |
| **智谱高级版** ⭐推荐 | 0.03元/次 | 多引擎协作，召回率和准确率大幅提升 | 专业问题、深度分析 |
| **搜狗** | 0.05元/次 | 覆盖腾讯生态和知乎内容，垂直领域权威 | 百科、医疗等专业领域 |
| **夸克** | 0.05元/次 | 精准触达垂直内容 | 特定领域深度搜索 |

### 3. 灵活配置
- **结果数量**：可设置返回1-50条搜索结果
- **内容长度**：
  - 中等：返回摘要信息，适合快速获取关键信息
  - 详细：返回完整内容，适合深度分析和详细解答

## 使用方法

### 启用联网搜索

1. **点击搜索按钮**
   - 在聊天输入框右侧找到搜索图标按钮
   - 点击按钮打开搜索配置弹窗

2. **配置搜索参数**
   - 选择搜索引擎类型（推荐使用智谱高级版）
   - 设置返回结果条数（建议5-10条）
   - 选择内容长度（根据需求选择）

3. **保存并启用**
   - 点击"保存并启用"按钮
   - 输入框上方会显示"联网搜索已启用"的提示
   - 搜索按钮会高亮显示

### 使用联网搜索

启用后，直接在输入框中输入问题并发送，AI会自动：
1. 分析问题是否需要网络搜索
2. 调用搜索API获取最新信息
3. 结合搜索结果生成回答
4. 在回答中标注信息来源

### 关闭联网搜索

再次点击搜索按钮即可关闭联网搜索功能。

## 使用示例

### 示例1：查询最新资讯
```
用户：2025年1月有哪些重要的科技新闻？

AI：[启用联网搜索]
根据最新的网络搜索结果，2025年1月的重要科技新闻包括：
1. [新闻标题1](来源链接)
   - 详细内容...
2. [新闻标题2](来源链接)
   - 详细内容...
...
```

### 示例2：专业领域查询
```
用户：最新的人工智能大模型有哪些突破？

AI：[启用联网搜索]
根据搜索结果，近期人工智能大模型领域的主要突破包括：
1. [突破1](来源链接)
   - 技术细节...
2. [突破2](来源链接)
   - 应用场景...
...
```

## 技术实现

### 前端实现
- 搜索状态管理：`appState.chat.searchMode`
- 配置界面：动态生成的模态弹窗
- 视觉反馈：搜索启用指示器和按钮高亮

### 后端实现
- API端点：`/stream_chat` 和 `/chat`
- 参数传递：通过 `tools` 参数配置 `web_search`
- 搜索引擎：调用智谱AI网络搜索API

### API参数说明
```javascript
{
  "enable_web_search": true,
  "search_engine": "search_pro",
  "search_count": 5,
  "content_size": "medium"
}
```

## 注意事项

1. **费用说明**
   - 每次搜索会产生相应费用（根据选择的搜索引擎）
   - 建议根据实际需求选择合适的搜索引擎

2. **性能考虑**
   - 搜索结果数量越多，响应时间越长
   - 建议设置5-10条结果以平衡速度和质量

3. **使用建议**
   - 对于需要最新信息的问题，启用联网搜索
   - 对于一般性知识问答，可以不启用搜索以节省费用
   - 专业领域问题建议使用智谱高级版或搜狗引擎

## 更新日志

### 2026-01-24
- ✅ 集成智谱AI网络搜索API
- ✅ 支持流式和非流式对话中的网络搜索
- ✅ 添加搜索配置界面
- ✅ 实现搜索状态视觉反馈
- ✅ 支持多种搜索引擎选择
- ✅ 添加详细的使用说明和提示

## 相关文档

- [智谱AI网络搜索API文档](https://docs.bigmodel.cn/api-reference/%E5%B7%A5%E5%85%B7-api/%E7%BD%91%E7%BB%9C%E6%90%9C%E7%B4%A2)
- [即时对话功能说明](./即时对话功能说明.md)
- [API集成指南](../guides/API集成指南.md)
