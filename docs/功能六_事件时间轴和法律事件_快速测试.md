# 功能六：事件时间轴和法律事件 - 快速测试指南

## 🎯 测试目标

验证事件时间轴（Events Timeline）和法律事件（Legal Events）已正确分离为两个独立字段。

## 📋 快速测试（5分钟）

### 步骤1：检查字段选择器 ✅

1. 打开功能六：批量专利解读
2. 点击"字段选择器"展开面板
3. 找到"法律与事件"分组

**检查点**：
- ✅ 有两个独立选项："事件时间轴" 和 "法律事件"
- ✅ 两个都默认选中（有勾选标记）
- ✅ 颜色为淡绿色系（不是蓝色）

### 步骤2：测试两个都选中 ✅

1. 确保两个都勾选：
   - ✅ 事件时间轴
   - ✅ 法律事件
2. 输入专利号：`US12390907B2`
3. 点击"批量查询专利"
4. 打开浏览器控制台（F12）

**检查点**：
- ✅ 控制台显示：`events_timeline: true, legal_events: true`
- ✅ 查询成功

5. 点击专利号条带，打开详情

**检查点**：
- ✅ 显示"事件时间轴"部分（Timeline样式，有圆点和连线）
- ✅ 显示"法律事件"部分（Table样式，有日期、代码、描述列）
- ✅ 左侧导航有两个独立链接

### 步骤3：测试只选事件时间轴 ✅

1. 回到功能六主页
2. 展开字段选择器
3. 取消勾选"法律事件"，保留"事件时间轴"
4. 输入专利号：`US12390907B2`
5. 点击"批量查询专利"
6. 打开详情

**检查点**：
- ✅ 显示"事件时间轴"部分
- ✅ 不显示"法律事件"部分

### 步骤4：测试只选法律事件 ✅

1. 回到功能六主页
2. 展开字段选择器
3. 取消勾选"事件时间轴"，保留"法律事件"
4. 输入专利号：`US12390907B2`
5. 点击"批量查询专利"
6. 打开详情

**检查点**：
- ✅ 不显示"事件时间轴"部分
- ✅ 显示"法律事件"部分

### 步骤5：测试两个都不选 ✅

1. 回到功能六主页
2. 展开字段选择器
3. 取消勾选"事件时间轴"和"法律事件"
4. 输入专利号：`US12390907B2`
5. 点击"批量查询专利"
6. 打开详情

**检查点**：
- ✅ 不显示"事件时间轴"部分
- ✅ 不显示"法律事件"部分

## 🔍 详细验证

### 事件时间轴内容验证

**预期内容**（US12390907B2）：
```
📅 事件时间轴 (7)

● 2018-07-13
  Application filed by Stanley Black and Decker Inc
  (filed)

● 2021-09-02
  Publication of US20210268630A1
  (publication)

● 2024-12-10
  Assigned to STANLEY BLACK & DECKER INC.
  (reassignment)

● 2025-08-19
  Application granted
  (granted)

● 2025-08-19
  Publication of US12390907B2
  (publication)

● Status
  Active
  (legal-status)

● 2040-12-23
  Adjusted expiration
  (legal-status)
```

**验证点**：
- ✅ 显示为Timeline样式（圆点、连线）
- ✅ 包含申请、公开、授权等关键事件
- ✅ 每个事件有日期、标题、类型

### 法律事件内容验证

**预期内容**（US12390907B2）：
```
⚖️ 法律事件 (9)

┌────────────┬──────┬─────────────────────────────────────┐
│ 日期       │ 代码 │ 描述                                 │
├────────────┼──────┼─────────────────────────────────────┤
│ 2021-01-13 │ FEPP │ Fee payment procedure                │
│ 2021-08-23 │ STPP │ Information on status: patent app... │
│ 2023-11-17 │ STPP │ Information on status: patent app... │
│ 2024-05-23 │ STPP │ Information on status: patent app... │
│ 2024-06-21 │ STPP │ Information on status: patent app... │
│ 2024-12-10 │ AS   │ Assignment                           │
│ 2024-12-25 │ STPP │ Information on status: patent app... │
│ 2025-01-07 │ STPP │ Information on status: patent app... │
│ 2025-07-16 │ STPP │ Information on status: patent app... │
└────────────┴──────┴─────────────────────────────────────┘
```

**验证点**：
- ✅ 显示为Table样式（表格）
- ✅ 包含USPTO法律状态代码（FEPP, STPP, AS等）
- ✅ 每个事件有日期、代码、描述

## 🐛 常见问题排查

### 问题1：只看到一个选项

**症状**：字段选择器中只有"事件时间轴"或"法律事件"一个选项

**排查**：
1. 检查 `frontend/index.html` 是否正确修改
2. 清除浏览器缓存
3. 强制刷新（Ctrl+Shift+R）

### 问题2：两个部分显示相同内容

**症状**：事件时间轴和法律事件显示的内容一样

**排查**：
1. 检查后端是否正确分离提取逻辑
2. 查看控制台日志，确认后端返回了两个不同的字段
3. 检查 `backend/scraper/simple_scraper.py` 是否正确修改

### 问题3：法律事件不显示

**症状**：勾选了"法律事件"但不显示

**排查**：
1. 检查专利是否有法律事件数据（有些专利可能没有）
2. 尝试其他专利号，如 US10000000B2
3. 查看控制台是否有错误

### 问题4：样式不对

**症状**：事件时间轴显示为表格，或法律事件显示为Timeline

**排查**：
1. 检查 `js/patentDetailNewTab.js` 是否正确修改
2. 清除浏览器缓存
3. 检查CSS文件是否正确加载

## ✅ 测试通过标准

- ✅ 字段选择器有两个独立选项
- ✅ 两个选项可以独立勾选/取消
- ✅ 事件时间轴显示为Timeline样式
- ✅ 法律事件显示为Table样式
- ✅ 内容不重复，数据正确
- ✅ 字段选择功能正常工作
- ✅ 控制台无错误

## 📝 测试报告模板

```
测试日期：____________________
测试人员：____________________
专利号：US12390907B2

测试结果：
□ 通过  □ 失败

详细结果：
1. 字段选择器：□ 通过  □ 失败
2. 两个都选中：□ 通过  □ 失败
3. 只选时间轴：□ 通过  □ 失败
4. 只选法律事件：□ 通过  □ 失败
5. 两个都不选：□ 通过  □ 失败
6. 内容正确性：□ 通过  □ 失败
7. 样式正确性：□ 通过  □ 失败

问题记录：
_________________________________
_________________________________
_________________________________

备注：
_________________________________
_________________________________
```

## 🚀 测试通过后的操作

1. **提交代码到Git**
   ```bash
   git add backend/scraper/simple_scraper.py backend/routes/patent.py frontend/index.html js/main.js js/patentDetailNewTab.js frontend/css/components/field-selector.css
   git commit -m "功能六：分离事件时间轴和法律事件 + 字段选择器淡绿色系"
   git push origin main
   ```

2. **部署到生产环境**

3. **通知用户**
   - 事件时间轴和法律事件已分离为两个独立字段
   - 可以独立选择需要的字段
   - 字段选择器改为淡绿色系

---

**测试指南创建时间**：2026-02-05
**预计测试时间**：5-10分钟
**测试专利号**：US12390907B2
