# 功能八快速诊断 - 识别率0%问题

## 🚀 快速开始

### 方法1: Web诊断工具（最简单）

1. **启动应用**
   ```bash
   python run_app.py
   ```

2. **打开诊断工具**
   
   在浏览器中访问：
   ```
   http://localhost:5000/test_drawing_marker_debug.html
   ```

3. **按步骤操作**
   - 上传图片
   - 输入说明书
   - 点击测试按钮

4. **查看结果**
   - 绿色 ✅ = 成功
   - 红色 ❌ = 失败（这里就是问题所在）

---

## 📋 检查清单

### ✅ 步骤1: 说明书格式检查

**测试方法:** 在诊断工具中点击"测试说明书解析"

**成功标准:** 提取到 > 0 个附图标记

**如果失败:**
- 检查格式是否正确
- 支持的格式：
  - `1电动工具、2外壳、3后盖`
  - `1…电动工具、2…外壳、3…后盖`
  - `1. 电动工具`

### ✅ 步骤2: 图片质量检查

**检查项目:**
- [ ] 图片清晰，无模糊
- [ ] 数字清晰可见
- [ ] 数字与背景对比度高
- [ ] 图片分辨率 ≥ 1000px

**如果不满足:**
- 使用更高质量的图片
- 增强图片对比度
- 放大图片

### ✅ 步骤3: OCR识别检查

**测试方法:** 点击"开始完整测试"

**成功标准:** 识别到 > 0 个数字序号

**如果失败（识别到0个）:**

#### 原因1: Tesseract未安装 ⚠️

**检查方法:**
```bash
tesseract --version
```

**如果报错，需要安装:**
1. 下载: https://github.com/UB-Mannheim/tesseract/wiki
2. 安装到默认路径
3. 添加到系统PATH
4. 重启应用

#### 原因2: 图片质量太差 ⚠️

**解决方法:**
- 使用原始高清图片
- 不要使用截图或压缩过的图片
- 确保数字清晰可见

#### 原因3: 数字太小 ⚠️

**解决方法:**
- 放大图片
- 裁剪出包含数字的区域

---

## 🔍 查看后端日志

启动应用后，后端会输出详细日志：

```
[DEBUG] 从说明书中提取到 41 个附图标记
[DEBUG] 附图标记映射: {'1': '电动工具', '2': '外壳', ...}
[DEBUG] 图片 drawing1.png OCR识别到 15 个数字/标记
  - 1 (置信度: 95%)
  - 2 (置信度: 87%)
  ...
```

**关键信息:**
- 如果"提取到 0 个附图标记" → 说明书格式问题
- 如果"OCR识别到 0 个数字" → OCR识别问题

---

## 💡 常见问题速查

| 问题 | 原因 | 解决方法 |
|------|------|----------|
| 提取到0个附图标记 | 说明书格式错误 | 使用支持的格式 |
| OCR识别到0个数字 | Tesseract未安装 | 安装Tesseract |
| OCR识别到0个数字 | 图片质量太差 | 使用高清图片 |
| 识别到文本但匹配率0% | 编号不一致 | 检查图片和说明书编号 |

---

## 📞 需要帮助？

如果使用诊断工具后仍然无法解决，请提供：

1. 诊断工具的截图
2. 后端控制台的日志
3. 测试图片（如果可以分享）
4. 说明书内容

---

**快速链接:**
- 详细文档: `功能八诊断工具使用说明.md`
- 测试脚本: `test_drawing_marker_parser.py`
- Web诊断: `http://localhost:5000/test_drawing_marker_debug.html`
