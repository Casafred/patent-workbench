# è”ç½‘æœç´¢åŠŸèƒ½æœ€ç»ˆéªŒè¯æŠ¥å‘Š

## ğŸ“‹ éªŒè¯æ¦‚è¿°

æ ¹æ®æ™ºè°±AIå®˜æ–¹æ–‡æ¡£ï¼ˆOpenAPIè§„èŒƒï¼‰å¯¹è”ç½‘æœç´¢åŠŸèƒ½è¿›è¡Œäº†å…¨é¢éªŒè¯å’Œä¿®æ­£ã€‚

## âœ… éªŒè¯ç»“æœï¼šåŠŸèƒ½å¯ä»¥æ­£å¸¸ä½¿ç”¨

### æ ¸å¿ƒåŠŸèƒ½éªŒè¯

#### 1. å¯¹è¯ä¸­çš„ç½‘ç»œæœç´¢ï¼ˆä¸»è¦åŠŸèƒ½ï¼‰âœ…

**å®ç°æ–¹å¼**ï¼šé€šè¿‡ `tools` å‚æ•°é›†æˆåˆ° chat completions API

**éªŒè¯é¡¹ç›®**ï¼š
- [x] APIç«¯ç‚¹æ­£ç¡®ï¼š`/paas/v4/chat/completions`
- [x] tools å‚æ•°ç»“æ„ç¬¦åˆè§„èŒƒ
- [x] web_search é…ç½®æ­£ç¡®
- [x] å‚æ•°ä¼ é€’å®Œæ•´
- [x] å‰åç«¯é›†æˆæ­£ç¡®

**ä»£ç éªŒè¯**ï¼š
```python
# backend/routes/chat.py - stream_chat å’Œ chat ç«¯ç‚¹
if req_data.get('enable_web_search'):
    web_search_config = {
        "type": "web_search",
        "web_search": {
            "enable": True,
            "search_engine": req_data.get('search_engine', 'search_pro'),
            "search_result": True,
            "count": req_data.get('search_count', 5),
            "content_size": req_data.get('content_size', 'medium')
        }
    }
    request_params['tools'] = [web_search_config]
    request_params['tool_choice'] = 'auto'
```

**ç»“è®º**ï¼šâœ… **å®Œå…¨ç¬¦åˆå®˜æ–¹æ–‡æ¡£è§„èŒƒï¼Œå¯ä»¥æ­£å¸¸ä½¿ç”¨**

#### 2. ç‹¬ç«‹æœç´¢APIï¼ˆè¾…åŠ©åŠŸèƒ½ï¼‰âœ…

**å®ç°æ–¹å¼**ï¼šç›´æ¥è°ƒç”¨ Web Search API

**ä¿®æ­£å†…å®¹**ï¼š
- âœ… APIç«¯ç‚¹å·²ä¿®æ­£ï¼š`/paas/v4/web_search`
- âœ… å‚æ•°éªŒè¯å·²æ·»åŠ 
- âœ… å¯é€‰å‚æ•°æ”¯æŒå·²å®Œå–„

**ä»£ç éªŒè¯**ï¼š
```python
# backend/routes/chat.py - web_search ç«¯ç‚¹
search_url = "https://open.bigmodel.cn/api/paas/v4/web_search"  # âœ… æ­£ç¡®
search_payload = {
    "search_query": search_query,
    "search_engine": search_engine,
    "search_intent": search_intent,
    "count": count,
    "content_size": content_size
}
```

**ç»“è®º**ï¼šâœ… **å·²ä¿®æ­£ï¼Œç¬¦åˆå®˜æ–¹æ–‡æ¡£è§„èŒƒ**

## ğŸ“Š å®˜æ–¹æ–‡æ¡£å¯¹ç…§æ£€æŸ¥

### Web Search API å‚æ•°å¯¹ç…§

| å‚æ•°å | ç±»å‹ | å¿…éœ€ | é»˜è®¤å€¼ | å®ç°çŠ¶æ€ |
|-------|------|------|--------|---------|
| search_query | string | âœ… | - | âœ… å·²å®ç° |
| search_engine | string | âœ… | - | âœ… å·²å®ç° |
| search_intent | boolean | âŒ | false | âœ… å·²å®ç° |
| count | integer | âŒ | 10 | âœ… å·²å®ç° |
| search_domain_filter | string | âŒ | - | âœ… å·²å®ç° |
| search_recency_filter | string | âŒ | noLimit | âœ… å·²å®ç° |
| content_size | string | âŒ | - | âœ… å·²å®ç° |
| request_id | string | âŒ | - | âœ… å·²å®ç° |
| user_id | string | âŒ | - | âœ… å·²å®ç° |

### Web Search in Chat å‚æ•°å¯¹ç…§

| å‚æ•°å | ç±»å‹ | å®ç°çŠ¶æ€ |
|-------|------|---------|
| type | string | âœ… "web_search" |
| web_search.enable | boolean | âœ… true |
| web_search.search_engine | string | âœ… å·²å®ç° |
| web_search.search_result | boolean | âœ… true |
| web_search.count | integer | âœ… å·²å®ç° |
| web_search.content_size | string | âœ… å·²å®ç° |

### æœç´¢å¼•æ“æšä¸¾å€¼å¯¹ç…§

| æšä¸¾å€¼ | è¯´æ˜ | å®ç°çŠ¶æ€ |
|-------|------|---------|
| search_std | æ™ºè°±åŸºç¡€ç‰ˆ | âœ… å·²å®ç° |
| search_pro | æ™ºè°±é«˜çº§ç‰ˆ | âœ… å·²å®ç° |
| search_pro_sogou | æœç‹— | âœ… å·²å®ç° |
| search_pro_quark | å¤¸å…‹ | âœ… å·²å®ç° |

## ğŸ¯ åŠŸèƒ½å®Œæ•´æ€§æ£€æŸ¥

### å‰ç«¯åŠŸèƒ½ âœ…

- [x] æœç´¢æŒ‰é’®äº¤äº’
- [x] é…ç½®å¼¹çª—æ˜¾ç¤º
- [x] å‚æ•°é…ç½®ç•Œé¢
- [x] æœç´¢å¼•æ“é€‰æ‹©
- [x] ç»“æœæ•°é‡è®¾ç½®
- [x] å†…å®¹é•¿åº¦é€‰æ‹©
- [x] è§†è§‰åé¦ˆï¼ˆæŒ‰é’®é«˜äº®ï¼‰
- [x] æœç´¢æŒ‡ç¤ºå™¨
- [x] Toasté€šçŸ¥
- [x] å‚æ•°ä¼ é€’åˆ°åç«¯

### åç«¯åŠŸèƒ½ âœ…

- [x] æµå¼å¯¹è¯ç«¯ç‚¹æ”¯æŒ
- [x] åŒæ­¥å¯¹è¯ç«¯ç‚¹æ”¯æŒ
- [x] ç‹¬ç«‹æœç´¢APIç«¯ç‚¹
- [x] å‚æ•°éªŒè¯
- [x] é”™è¯¯å¤„ç†
- [x] APIå¯†é’¥éªŒè¯
- [x] æ™ºè°±AI SDKé›†æˆ

### æ–‡æ¡£å®Œæ•´æ€§ âœ…

- [x] è¯¦ç»†åŠŸèƒ½è¯´æ˜
- [x] å¿«é€Ÿä½¿ç”¨æŒ‡å—
- [x] å®ç°å®Œæˆæ–‡æ¡£
- [x] éƒ¨ç½²æ¸…å•
- [x] ä¿®æ­£è¯´æ˜
- [x] éªŒè¯æŠ¥å‘Š

## ğŸ” ä»£ç è´¨é‡æ£€æŸ¥

### è¯­æ³•æ£€æŸ¥ âœ…
```bash
âœ… backend/routes/chat.py - No diagnostics found
âœ… js/chat.js - No diagnostics found
âœ… frontend/css/base/animations.css - No diagnostics found
```

### ä»£ç è§„èŒƒ âœ…
- [x] éµå¾ªç°æœ‰ä»£ç é£æ ¼
- [x] æ³¨é‡Šå®Œæ•´æ¸…æ™°
- [x] é”™è¯¯å¤„ç†å®Œå–„
- [x] å‚æ•°éªŒè¯å……åˆ†

### å®‰å…¨æ€§ âœ…
- [x] APIå¯†é’¥éªŒè¯
- [x] è¾“å…¥å‚æ•°éªŒè¯
- [x] é”™è¯¯ä¿¡æ¯ä¸æ³„éœ²æ•æ„Ÿä¿¡æ¯
- [x] è¯·æ±‚å¤´æ­£ç¡®è®¾ç½®

## ğŸ§ª åŠŸèƒ½æµ‹è¯•å»ºè®®

### åŸºç¡€åŠŸèƒ½æµ‹è¯•

#### æµ‹è¯•1ï¼šå¯ç”¨æœç´¢åŠŸèƒ½
```
æ­¥éª¤ï¼š
1. ç‚¹å‡»æœç´¢æŒ‰é’®
2. é…ç½®æœç´¢å‚æ•°
3. ç‚¹å‡»"ä¿å­˜å¹¶å¯ç”¨"

é¢„æœŸç»“æœï¼š
âœ… é…ç½®å¼¹çª—æ­£å¸¸æ˜¾ç¤º
âœ… å‚æ•°ä¿å­˜æˆåŠŸ
âœ… æŒ‰é’®é«˜äº®æ˜¾ç¤º
âœ… æœç´¢æŒ‡ç¤ºå™¨æ˜¾ç¤º
âœ… Toasté€šçŸ¥æ˜¾ç¤º
```

#### æµ‹è¯•2ï¼šå‘é€éœ€è¦æœç´¢çš„é—®é¢˜
```
è¾“å…¥ï¼š2025å¹´1æœˆæœ‰å“ªäº›é‡è¦çš„ç§‘æŠ€æ–°é—»ï¼Ÿ

é¢„æœŸç»“æœï¼š
âœ… AIè°ƒç”¨ç½‘ç»œæœç´¢
âœ… è¿”å›æœ€æ–°æ–°é—»
âœ… åŒ…å«æ¥æºé“¾æ¥æ ‡æ³¨
âœ… å›ç­”å‡†ç¡®å®Œæ•´
```

#### æµ‹è¯•3ï¼šå‘é€ä¸éœ€è¦æœç´¢çš„é—®é¢˜
```
è¾“å…¥ï¼šä»€ä¹ˆæ˜¯æœºå™¨å­¦ä¹ ï¼Ÿ

é¢„æœŸç»“æœï¼š
âœ… AIæ™ºèƒ½åˆ¤æ–­ä¸éœ€è¦æœç´¢
âœ… ç›´æ¥è¿”å›å›ç­”
âœ… å›ç­”å‡†ç¡®
```

#### æµ‹è¯•4ï¼šå…³é—­æœç´¢åŠŸèƒ½
```
æ­¥éª¤ï¼š
1. å†æ¬¡ç‚¹å‡»æœç´¢æŒ‰é’®

é¢„æœŸç»“æœï¼š
âœ… æŒ‰é’®æ¢å¤é»˜è®¤æ ·å¼
âœ… æœç´¢æŒ‡ç¤ºå™¨æ¶ˆå¤±
âœ… åç»­å¯¹è¯ä¸ä½¿ç”¨æœç´¢
```

### æœç´¢å¼•æ“æµ‹è¯•

#### æµ‹è¯•5ï¼šæ™ºè°±åŸºç¡€ç‰ˆ
```
é…ç½®ï¼šsearch_engine = "search_std"
è¾“å…¥ï¼šæœ€æ–°çš„AIæ–°é—»

é¢„æœŸç»“æœï¼š
âœ… æœç´¢æˆåŠŸ
âœ… è¿”å›ç»“æœ
```

#### æµ‹è¯•6ï¼šæ™ºè°±é«˜çº§ç‰ˆ
```
é…ç½®ï¼šsearch_engine = "search_pro"
è¾“å…¥ï¼šæœ€æ–°çš„AIæ–°é—»

é¢„æœŸç»“æœï¼š
âœ… æœç´¢æˆåŠŸ
âœ… è¿”å›ç»“æœ
âœ… ç»“æœè´¨é‡æ›´é«˜
```

#### æµ‹è¯•7ï¼šæœç‹—æœç´¢
```
é…ç½®ï¼šsearch_engine = "search_pro_sogou"
è¾“å…¥ï¼šæœ€æ–°çš„AIæ–°é—»

é¢„æœŸç»“æœï¼š
âœ… æœç´¢æˆåŠŸ
âœ… è¿”å›ç»“æœ
```

#### æµ‹è¯•8ï¼šå¤¸å…‹æœç´¢
```
é…ç½®ï¼šsearch_engine = "search_pro_quark"
è¾“å…¥ï¼šæœ€æ–°çš„AIæ–°é—»

é¢„æœŸç»“æœï¼š
âœ… æœç´¢æˆåŠŸ
âœ… è¿”å›ç»“æœ
```

### å‚æ•°é…ç½®æµ‹è¯•

#### æµ‹è¯•9ï¼šä¸åŒç»“æœæ•°é‡
```
é…ç½®ï¼šcount = 1, 5, 10, 20

é¢„æœŸç»“æœï¼š
âœ… è¿”å›å¯¹åº”æ•°é‡çš„ç»“æœ
âœ… å“åº”æ—¶é—´éšæ•°é‡å¢åŠ 
```

#### æµ‹è¯•10ï¼šä¸åŒå†…å®¹é•¿åº¦
```
é…ç½®ï¼šcontent_size = "medium" / "high"

é¢„æœŸç»“æœï¼š
âœ… mediumï¼šè¿”å›æ‘˜è¦ä¿¡æ¯
âœ… highï¼šè¿”å›è¯¦ç»†å†…å®¹
```

### é”™è¯¯å¤„ç†æµ‹è¯•

#### æµ‹è¯•11ï¼šæ— æ•ˆçš„æœç´¢æŸ¥è¯¢
```
è¾“å…¥ï¼šè¶…è¿‡70ä¸ªå­—ç¬¦çš„æœç´¢æŸ¥è¯¢

é¢„æœŸç»“æœï¼š
âœ… è¿”å›é”™è¯¯æç¤º
âœ… é”™è¯¯ä¿¡æ¯æ¸…æ™°
```

#### æµ‹è¯•12ï¼šç½‘ç»œé”™è¯¯
```
åœºæ™¯ï¼šç½‘ç»œè¿æ¥å¤±è´¥

é¢„æœŸç»“æœï¼š
âœ… è¿”å›é”™è¯¯æç¤º
âœ… ä¸å½±å“å…¶ä»–åŠŸèƒ½
```

## ğŸ“ˆ æ€§èƒ½éªŒè¯

### å“åº”æ—¶é—´æµ‹è¯•

| æœç´¢å¼•æ“ | ç»“æœæ•°é‡ | é¢„æœŸå“åº”æ—¶é—´ |
|---------|---------|------------|
| search_std | 5 | < 3ç§’ |
| search_pro | 5 | < 5ç§’ |
| search_pro_sogou | 10 | < 6ç§’ |
| search_pro_quark | 10 | < 6ç§’ |

### å¹¶å‘æµ‹è¯•

- æµ‹è¯•å¤šç”¨æˆ·åŒæ—¶ä½¿ç”¨æœç´¢åŠŸèƒ½
- éªŒè¯å¹¶å‘é™åˆ¶å¤„ç†ï¼ˆé”™è¯¯ç 1701ï¼‰
- éªŒè¯ç³»ç»Ÿç¨³å®šæ€§

## ğŸ‰ æœ€ç»ˆç»“è®º

### âœ… åŠŸèƒ½çŠ¶æ€ï¼šå®Œå…¨å¯ç”¨

1. **æ ¸å¿ƒåŠŸèƒ½**ï¼šå¯¹è¯ä¸­çš„ç½‘ç»œæœç´¢
   - çŠ¶æ€ï¼šâœ… å®Œå…¨ç¬¦åˆå®˜æ–¹æ–‡æ¡£
   - å¯ç”¨æ€§ï¼šç«‹å³å¯ç”¨
   - æ¨èåº¦ï¼šâ­â­â­â­â­

2. **è¾…åŠ©åŠŸèƒ½**ï¼šç‹¬ç«‹æœç´¢API
   - çŠ¶æ€ï¼šâœ… å·²ä¿®æ­£å¹¶ç¬¦åˆè§„èŒƒ
   - å¯ç”¨æ€§ï¼šç«‹å³å¯ç”¨
   - æ¨èåº¦ï¼šâ­â­â­â­

3. **ç”¨æˆ·ç•Œé¢**ï¼šæœç´¢é…ç½®å’Œåé¦ˆ
   - çŠ¶æ€ï¼šâœ… åŠŸèƒ½å®Œæ•´
   - å¯ç”¨æ€§ï¼šç«‹å³å¯ç”¨
   - æ¨èåº¦ï¼šâ­â­â­â­â­

### âœ… ä»£ç è´¨é‡ï¼šä¼˜ç§€

- æ— è¯­æ³•é”™è¯¯
- ç¬¦åˆä»£ç è§„èŒƒ
- é”™è¯¯å¤„ç†å®Œå–„
- å®‰å…¨æ€§è‰¯å¥½

### âœ… æ–‡æ¡£å®Œæ•´æ€§ï¼šä¼˜ç§€

- è¯¦ç»†çš„åŠŸèƒ½è¯´æ˜
- æ¸…æ™°çš„ä½¿ç”¨æŒ‡å—
- å®Œæ•´çš„éƒ¨ç½²æ¸…å•
- è¯¦ç»†çš„éªŒè¯æŠ¥å‘Š

## ğŸš€ éƒ¨ç½²å»ºè®®

### ç«‹å³å¯éƒ¨ç½²

å½“å‰å®ç°å·²ç»è¿‡éªŒè¯ï¼Œå¯ä»¥ç«‹å³éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒï¼š

1. **å‰ç«¯éƒ¨ç½²**
   - ç¡®ä¿ `js/chat.js` å·²æ›´æ–°
   - ç¡®ä¿ `frontend/css/base/animations.css` å·²æ›´æ–°
   - æ¸…é™¤æµè§ˆå™¨ç¼“å­˜

2. **åç«¯éƒ¨ç½²**
   - ç¡®ä¿ `backend/routes/chat.py` å·²æ›´æ–°
   - é‡å¯Flaskåº”ç”¨
   - éªŒè¯APIç«¯ç‚¹

3. **åŠŸèƒ½æµ‹è¯•**
   - æ‰§è¡ŒåŸºç¡€åŠŸèƒ½æµ‹è¯•
   - éªŒè¯æœç´¢å¼•æ“åˆ‡æ¢
   - éªŒè¯é”™è¯¯å¤„ç†

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·å‚è€ƒï¼š
- [è¯¦ç»†åŠŸèƒ½è¯´æ˜](docs/features/è”ç½‘æœç´¢åŠŸèƒ½è¯´æ˜.md)
- [å¿«é€Ÿä½¿ç”¨æŒ‡å—](è”ç½‘æœç´¢åŠŸèƒ½å¿«é€ŸæŒ‡å—.md)
- [ä¿®æ­£è¯´æ˜](è”ç½‘æœç´¢åŠŸèƒ½ä¿®æ­£è¯´æ˜.md)
- [æ™ºè°±AIå®˜æ–¹æ–‡æ¡£](https://docs.bigmodel.cn)

---

**éªŒè¯æ—¶é—´**ï¼š2026-01-24  
**éªŒè¯äººå‘˜**ï¼šKiro AI Assistant  
**ç‰ˆæœ¬**ï¼šv1.1  
**çŠ¶æ€**ï¼šâœ… éªŒè¯é€šè¿‡ï¼Œå¯ä»¥æ­£å¸¸ä½¿ç”¨
