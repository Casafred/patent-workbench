<!-- 功能六：批量专利解读 -->
<!-- ====================================================================== -->
<div id="patent_batch-tab" class="tab-content">
    <div class="step">
        <div class="step-header">批量专利查询与解读</div>
        <p class="info">输入专利号列表（支持换行符或空格分隔），系统将批量查询专利详情并提供AI解读功能。最多支持50个专利号。</p>
        
        <!-- 专利号输入和配置区域 - 新布局 -->
        <div class="patent-batch-config-grid">
            <!-- 左侧：专利号输入 -->
            <div class="patent-input-section">
                <label for="patent_numbers_input">专利号列表：</label>
                <div class="patent-input-wrapper">
                    <textarea id="patent_numbers_input" rows="8" placeholder="请输入专利号，用换行符或空格分隔（最多50个）"></textarea>
                    <button id="copy_patent_numbers_btn" class="copy-btn-overlay" title="复制专利号">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/>
                            <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/>
                        </svg>
                    </button>
                </div>
                <div class="patent-input-footer">
                    <span id="patent_count_display">专利号数量：0/50</span>
                    <button id="clear_patent_input_btn" class="small-button delete-button">清空</button>
                </div>
            </div>
            
            <!-- 右侧：配置选项 -->
            <div class="patent-config-section">
                <!-- 解读模板 -->
                <div class="config-item-compact">
                    <label for="patent_template_selector">解读模板：</label>
                    <div class="config-input-group">
                        <select id="patent_template_selector">
                            <!-- 默认选项，会被JavaScript动态更新 -->
                            <optgroup label="📋 预设模板">
                                <option value="default">默认模板</option>
                                <option value="technical">技术分析模板</option>
                                <option value="business">商业价值模板</option>
                                <option value="legal">法律分析模板</option>
                            </optgroup>
                        </select>
                        <button id="manage_template_btn" class="small-button">管理</button>
                    </div>
                </div>
                
                <!-- 解读模型 -->
                <div class="config-item-compact">
                    <label for="patent_batch_model_selector">解读模型：</label>
                    <select id="patent_batch_model_selector">
                        <option value="GLM-4-Flash">GLM-4-Flash（推荐）</option>
                        <option value="GLM-4-Plus">GLM-4-Plus（高质量）</option>
                        <option value="GLM-4-Air">GLM-4-Air（平衡）</option>
                        <option value="GLM-4-0520">GLM-4-0520（稳定版）</option>
                    </select>
                </div>
                
                <!-- 爬取模式选择 -->
                <div class="config-item-compact">
                    <div class="crawl-mode-selector" style="display: flex; gap: 8px; margin-bottom: 10px;">
                        <button id="quick_crawl_btn" class="small-button primary-btn" style="flex: 1;" title="快速爬取所有字段，不看字段选择器">
                            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 16 16" style="margin-right: 4px;">
                                <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
                            </svg>
                            快速全爬取
                        </button>
                        <button id="toggle_field_selector_btn" class="small-button" style="flex: 1;" title="展开字段选择器，选择性爬取">
                            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 16 16" style="margin-right: 4px;">
                                <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
                            </svg>
                            选择性爬取
                        </button>
                    </div>
                </div>
                
                <!-- 操作按钮 -->
                <div class="config-actions">
                    <button id="search_patents_btn" class="small-button primary-btn" style="display: none;">批量查询专利</button>
                    <button id="analyze_all_btn" class="small-button primary-btn" disabled>批量解读</button>
                </div>
            </div>
        </div>
        
        <!-- 字段选择器面板（折叠） -->
        <div id="field_selector_panel" class="field-selector-container" style="display: none; margin-top: 20px;">
            <div class="field-selector-header">
                <div class="field-selector-title">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                        <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                        <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
                    </svg>
                    选择爬取字段
                </div>
                <div class="field-selector-actions">
                    <button class="field-selector-btn" onclick="selectAllOptionalFields()">全选可选</button>
                    <button class="field-selector-btn" onclick="deselectAllOptionalFields()">取消全选</button>
                    <button class="field-selector-btn" onclick="selectRecommendedFields()">推荐配置</button>
                </div>
            </div>
            
            <!-- 基础字段（必选） -->
            <div class="field-group">
                <div class="field-group-title">
                    基础字段
                    <span class="field-group-badge required">必选</span>
                </div>
                <div class="field-options-grid">
                    <div class="field-option disabled checked">
                        <input type="checkbox" checked disabled>
                        <span class="field-option-label">专利号</span>
                    </div>
                    <div class="field-option disabled checked">
                        <input type="checkbox" checked disabled>
                        <span class="field-option-label">标题</span>
                    </div>
                    <div class="field-option disabled checked">
                        <input type="checkbox" checked disabled>
                        <span class="field-option-label">摘要</span>
                    </div>
                    <div class="field-option disabled checked">
                        <input type="checkbox" checked disabled>
                        <span class="field-option-label">发明人</span>
                    </div>
                    <div class="field-option disabled checked">
                        <input type="checkbox" checked disabled>
                        <span class="field-option-label">申请人</span>
                    </div>
                    <div class="field-option disabled checked">
                        <input type="checkbox" checked disabled>
                        <span class="field-option-label">申请日期</span>
                    </div>
                    <div class="field-option disabled checked">
                        <input type="checkbox" checked disabled>
                        <span class="field-option-label">公开日期</span>
                    </div>
                    <div class="field-option disabled checked">
                        <input type="checkbox" checked disabled>
                        <span class="field-option-label">权利要求</span>
                    </div>
                </div>
            </div>
            
            <!-- 可选字段 -->
            <div class="field-group">
                <div class="field-group-title">
                    分类与领域
                    <span class="field-group-badge">可选</span>
                </div>
                <div class="field-options-grid">
                    <div class="field-option" onclick="toggleFieldOption(this)">
                        <input type="checkbox" id="field_classifications" checked>
                        <span class="field-option-label">
                            CPC分类
                            <span class="field-option-info">推荐</span>
                        </span>
                    </div>
                    <div class="field-option" onclick="toggleFieldOption(this)">
                        <input type="checkbox" id="field_landscapes" checked>
                        <span class="field-option-label">
                            技术领域
                            <span class="field-option-info">推荐</span>
                        </span>
                    </div>
                    <div class="field-option" onclick="toggleFieldOption(this)">
                        <input type="checkbox" id="field_priority_date">
                        <span class="field-option-label">优先权日期</span>
                    </div>
                </div>
            </div>
            
            <div class="field-group">
                <div class="field-group-title">
                    同族信息
                    <span class="field-group-badge">可选</span>
                </div>
                <div class="field-options-grid">
                    <div class="field-option" onclick="toggleFieldOption(this)">
                        <input type="checkbox" id="field_family_id">
                        <span class="field-option-label">同族ID</span>
                    </div>
                    <div class="field-option" onclick="toggleFieldOption(this)">
                        <input type="checkbox" id="field_family_applications">
                        <span class="field-option-label">
                            同族申请
                            <span class="field-option-info">耗时</span>
                        </span>
                    </div>
                    <div class="field-option" onclick="toggleFieldOption(this)">
                        <input type="checkbox" id="field_country_status">
                        <span class="field-option-label">
                            国家状态
                            <span class="field-option-info">耗时</span>
                        </span>
                    </div>
                </div>
            </div>
            
            <div class="field-group">
                <div class="field-group-title">
                    引用信息
                    <span class="field-group-badge">可选</span>
                </div>
                <div class="field-options-grid">
                    <div class="field-option" onclick="toggleFieldOption(this)">
                        <input type="checkbox" id="field_patent_citations" checked>
                        <span class="field-option-label">
                            引用专利
                            <span class="field-option-info">推荐</span>
                        </span>
                    </div>
                    <div class="field-option" onclick="toggleFieldOption(this)">
                        <input type="checkbox" id="field_cited_by" checked>
                        <span class="field-option-label">
                            被引用专利
                            <span class="field-option-info">推荐</span>
                        </span>
                    </div>
                </div>
            </div>
            
            <div class="field-group">
                <div class="field-group-title">
                    法律与事件
                    <span class="field-group-badge">可选</span>
                </div>
                <div class="field-options-grid">
                    <div class="field-option" onclick="toggleFieldOption(this)">
                        <input type="checkbox" id="field_events_timeline" checked>
                        <span class="field-option-label">
                            事件时间轴
                            <span class="field-option-info">推荐</span>
                        </span>
                    </div>
                    <div class="field-option" onclick="toggleFieldOption(this)">
                        <input type="checkbox" id="field_legal_events" checked>
                        <span class="field-option-label">
                            法律事件
                            <span class="field-option-info">推荐</span>
                        </span>
                    </div>
                    <div class="field-option" onclick="toggleFieldOption(this)">
                        <input type="checkbox" id="field_similar_documents">
                        <span class="field-option-label">相似文档</span>
                    </div>
                </div>
            </div>
            
            <div class="field-group">
                <div class="field-group-title">
                    附加内容
                    <span class="field-group-badge">可选</span>
                </div>
                <div class="field-options-grid">
                    <div class="field-option" onclick="toggleFieldOption(this)">
                        <input type="checkbox" id="field_description">
                        <span class="field-option-label">
                            说明书
                            <span class="field-option-info">耗时</span>
                        </span>
                    </div>
                    <div class="field-option" onclick="toggleFieldOption(this)">
                        <input type="checkbox" id="field_drawings" checked>
                        <span class="field-option-label">
                            附图
                            <span class="field-option-info">推荐</span>
                        </span>
                    </div>
                    <div class="field-option" onclick="toggleFieldOption(this)">
                        <input type="checkbox" id="field_external_links">
                        <span class="field-option-label">外部链接</span>
                    </div>
                </div>
            </div>
            
            <!-- 统计信息 -->
            <div class="field-selector-stats">
                <div class="field-selector-count">
                    已选择 <strong id="selected_fields_count">11</strong> 个字段（基础8个 + 可选3个）
                </div>
            </div>
            
            <!-- 性能警告 -->
            <div id="field_selector_warning" class="field-selector-warning" style="display: none;">
                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 16 16">
                    <path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/>
                </svg>
                您选择了多个耗时字段，爬取时间可能较长
            </div>
        </div>
        
        <!-- 模板编辑器（折叠） -->
        <div id="template_editor" class="template-editor-panel" style="display: none;">
            <div class="template-info">
                <input type="text" id="template_name" placeholder="模板名称">
                <textarea id="template_description" placeholder="模板描述（可选）" rows="2"></textarea>
            </div>
            
            <div class="fields-container">
                <h5>字段配置：</h5>
                <div id="fields_list"></div>
                <button class="small-button" id="add_field_btn">+ 添加字段</button>
            </div>
            
            <div class="template-actions">
                <button class="small-button" id="patent_save_template_btn">保存模板</button>
                <button class="small-button" id="patent_new_template_btn">新建模板</button>
                <button class="small-button delete-button" id="patent_delete_template_btn">删除模板</button>
                <button class="small-button" id="patent_export_template_btn">导出模板</button>
                <button class="small-button" id="patent_import_template_btn">导入模板</button>
                <button class="small-button" id="cancel_edit_btn">取消</button>
            </div>
        </div>
        
        <!-- 查询结果状态 -->
        <div id="search_status" class="info" style="margin-top: 15px; display: none;"></div>
        
        <!-- 查询结果列表 - 简化为专利号条带 -->
        <div id="patent_results_container" style="margin-top: 20px; display: none;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                <h4>查询结果</h4>
                <button id="export_analysis_excel_btn" class="small-button" disabled>导出为Excel</button>
            </div>
            <div id="patent_results_list" class="patent-strip-list"></div>
        </div>
        
        <!-- 专利详情弹窗 -->
        <div id="patent_detail_modal" class="modal" style="display: none;">
            <div class="modal-content" style="max-width: 900px; max-height: 90vh; overflow-y: auto;">
                <div class="modal-header">
                    <!-- 关闭按钮已移至JS中动态生成，位于左上角 -->
                </div>
                <div class="modal-body" id="patent_detail_body">
                    <!-- 动态填充专利详情 -->
                </div>
            </div>
        </div>
    </div>
</div>

<!-- ====================================================================== -->
