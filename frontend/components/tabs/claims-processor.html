<!-- 功能七：权利要求处理 -->
<!-- ====================================================================== -->
<div id="claims_processor-tab" class="tab-content">
    <!-- 子标签页导航 -->
    <div class="sub-tab-container" style="margin-bottom: 25px;">
        <button class="sub-tab-button active" onclick="switchClaimsSubTab('excel')">Excel批量分析</button>
        <button class="sub-tab-button" onclick="switchClaimsSubTab('text')">文本输入分析</button>
    </div>
    
    <!-- Excel批量分析页面 -->
    <div id="claims-excel-tab" class="claims-sub-tab active">
        <div class="step">
            <div class="step-header">Excel批量权利要求分析</div>
            <p class="info">上传包含专利权利要求的Excel文件，系统将自动解析、分类并提取权利要求信息。支持中英文混合文本。</p>
        
        <div class="config-item">
            <label for="claims_excel_file">上传Excel文件:</label>
            <input type="file" id="claims_excel_file" accept=".xlsx, .xls">
        </div>
        
        <div id="claims_sheet_selector_container" style="display:none; margin-top: 15px;">
            <div class="config-item">
                <label for="claims_sheet_selector">选择工作表:</label>
                <select id="claims_sheet_selector"></select>
            </div>
        </div>
        
        <div id="claims_column_selector_container" style="display:none; margin-top: 15px;">
            <div class="config-item">
                <label for="claims_column_selector">选择权利要求列:</label>
                <select id="claims_column_selector"></select>
            </div>
        </div>
        
        <div style="text-align: center; margin-top: 25px;">
            <button id="claims_process_btn" class="small-button" disabled>开始处理</button>
        </div>
        
        <div id="claims_progress_container" style="display:none; margin-top: 25px;">
            <div class="config-item">
                <label>处理进度:</label>
                <div style="background: var(--surface-color); border: 1px solid var(--border-color); border-radius: 8px; padding: 10px; margin-top: 10px;">
                    <div id="claims_progress_bar" style="width: 0%; height: 20px; background: linear-gradient(90deg, var(--primary-color), var(--primary-color-dark)); border-radius: 4px; transition: width 0.3s;"></div>
                    <div id="claims_progress_text" style="text-align: center; margin-top: 10px; font-weight: 500;">0%</div>
                </div>
            </div>
        </div>
        
        <div id="claims_results_container" style="display:none; margin-top: 25px;">
            <h4>处理结果</h4>
            <div id="claims_stats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
                <div class="stat-card">
                    <div class="stat-label">处理单元格数</div>
                    <div class="stat-value" id="claims_stat_cells">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">提取权利要求数</div>
                    <div class="stat-value" id="claims_stat_total">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">独立权利要求</div>
                    <div class="stat-value" id="claims_stat_independent">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">从属权利要求</div>
                    <div class="stat-value" id="claims_stat_dependent">0</div>
                </div>
            </div>
            
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                <h4 style="margin: 0;">权利要求详情</h4>
                <div style="display: flex; gap: 10px;">
                    <button id="claims_export_excel_btn" class="small-button">导出Excel</button>
                    <button id="claims_export_json_btn" class="small-button">导出JSON</button>
                </div>
            </div>
            
            <div style="max-height: 400px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 8px;">
                <table id="claims_results_table">
                    <thead>
                        <tr>
                            <th>序号</th>
                            <th>类型</th>
                            <th>语言</th>
                            <th>引用</th>
                            <th>权利要求内容</th>
                            <th>置信度</th>
                        </tr>
                    </thead>
                    <tbody id="claims_results_tbody"></tbody>
                </table>
            </div>
        </div>
        
        <!-- 新增：公开号与独权合并视窗 -->
        <div id="claims_patent_summary_section" style="display:none; margin-top: 30px;">
            <h4>公开号与独权合并内容</h4>
            <p class="info">显示每个公开号及其对应的独立权利要求合并内容，点击按钮可跳转到权利要求引用图</p>
            
            <div style="max-height: 400px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 8px;">
                <table id="claims_patent_summary_table">
                    <thead>
                        <tr>
                            <th>公开号</th>
                            <th>独权合并内容</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody id="claims_patent_summary_tbody"></tbody>
                </table>
            </div>
        </div>
        
        <!-- 新增：专利查询和可视化区域 -->
        <div id="claims_patent_query_section" style="display:none; margin-top: 30px;">
            <h4>专利号查询与可视化</h4>
            <p class="info">搜索Excel中的专利号，并生成权利要求引用关系图</p>
            
            <div class="config-item">
                <label for="claims_patent_search_input">搜索专利号:</label>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <input type="text" id="claims_patent_search_input" placeholder="输入专利号片段进行搜索..." style="flex: 1;">
                    <button id="claims_search_patent_btn" class="small-button">搜索</button>
                </div>
            </div>
            
            <div id="claims_search_results_container" style="display:none; margin-top: 20px;">
                <h5>搜索结果</h5>
                <div id="claims_search_results" style="max-height: 200px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 8px; padding: 10px;">
                </div>
            </div>
            
            <div id="claims_selected_patent_info" style="display:none; margin-top: 20px;">
                <h5>已选择专利</h5>
                <div style="background: var(--surface-color); border: 1px solid var(--border-color); border-radius: 8px; padding: 15px;">
                    <p><strong>专利号:</strong> <span id="claims_selected_patent_number">-</span></p>
                    <p><strong>Excel行号:</strong> <span id="claims_selected_patent_row">-</span></p>
                    <div style="text-align: center; margin-top: 15px;">
                        <button id="claims_visualize_patent_btn" class="small-button">生成权利要求关系图</button>
                    </div>
                </div>
            </div>
            
            <div id="claims_visualization_section" style="display:none; margin-top: 30px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <h5 style="margin: 0;">权利要求引用关系图</h5>
                    <div style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
                        <label for="claims_style_selector">样式:</label>
                        <select id="claims_style_selector">
                            <option value="tree">树状图</option>
                            <option value="network">网络图</option>
                            <option value="radial">径向图</option>
                        </select>
                        
                        <!-- 树状图散开程度控制 -->
                        <div id="claims_tree_spread_control" style="display: flex; gap: 5px; align-items: center;">
                            <label for="claims_tree_spread_slider" style="font-size: 0.9em;">散开:</label>
                            <input type="range" id="claims_tree_spread_slider" min="0.5" max="5.0" step="0.1" value="1.0" style="width: 80px;">
                            <span id="claims_tree_spread_value" style="font-size: 0.9em; min-width: 30px;">1.0x</span>
                        </div>
                        
                        <button id="claims_zoom_in" class="small-button" title="放大">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path><line x1="11" y1="8" x2="11" y2="14"></line><line x1="8" y1="11" x2="14" y2="11"></line></svg>
                        </button>
                        <button id="claims_zoom_out" class="small-button" title="缩小">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path><line x1="8" y1="11" x2="14" y2="11"></line></svg>
                        </button>
                        <button id="claims_zoom_reset" class="small-button" title="重置">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path><path d="M21 3v5h-5"></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path><path d="M3 21v-5h5"></path></svg>
                        </button>
                        <button id="claims_center_view" class="small-button" title="居中">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><circle cx="12" cy="12" r="3"></circle></svg>
                        </button>
                        <button id="claims_screenshot_btn" class="small-button" title="高清截图">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path><circle cx="12" cy="13" r="4"></circle></svg>
                        </button>
                    </div>
                </div>
                
                <div id="claims_viz_loading_indicator" style="display:none; text-align: center; padding: 40px;">
                    <div class="loading-spinner"></div>
                    <p>正在生成可视化...</p>
                </div>
                
                <div id="claims_viz_error_message" style="display:none; text-align: center; padding: 40px; color: var(--error-color);">
                    <p>
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="vertical-align: middle; margin-right: 6px;"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
                        生成可视化失败
                    </p>
                    <p id="claims_viz_error_text">未知错误</p>
                </div>
                
                <div id="claims_visualization_container" style="width: 100%; height: 600px; border: 1px solid var(--border-color); border-radius: 8px; background: var(--surface-color);">
                </div>
            </div>
        </div>
        
    </div>
    </div>
    <!-- Excel批量分析页面结束 -->
    
    <!-- 文本输入分析页面 -->
    <div id="claims-text-tab" class="claims-sub-tab" style="display:none;">
        <div class="step">
            <div class="step-header">文本输入权利要求分析</div>
            <p class="info">直接输入权利要求文本，系统将自动识别独立权利要求（蓝色高亮）和从属权利要求（灰色显示），并生成可视化引证关系图。</p>
            
            <div class="config-item">
                <label for="claims_text_input">输入权利要求文本:</label>
                <textarea id="claims_text_input" rows="15" placeholder="示例：
1. 一种智能手机，其特征在于，包括：
   处理器，用于执行指令；
   存储器，与所述处理器连接，用于存储数据；
   显示屏，与所述处理器连接，用于显示信息。

2. 根据权利要求1所述的智能手机，其特征在于，所述处理器为八核处理器。

3. 根据权利要求1或2所述的智能手机，其特征在于，所述存储器容量为8GB以上。" style="width: 100%; padding: 15px; border: 1px solid var(--border-color); border-radius: 8px; font-family: 'Noto Sans SC', sans-serif; font-size: 14px; line-height: 1.6;"></textarea>
            </div>
            
            <div style="text-align: center; margin-top: 20px; display: flex; gap: 15px; justify-content: center;">
                <button id="claims_text_analyze_btn" class="small-button">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="vertical-align: middle; margin-right: 4px;"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path></svg>
                    开始分析
                </button>
                <button id="claims_text_clear_btn" class="small-button" style="background: #6c757d;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="vertical-align: middle; margin-right: 4px;"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>
                    清空
                </button>
                <button id="claims_text_example_btn" class="small-button" style="background: #28a745;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="vertical-align: middle; margin-right: 4px;"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>
                    加载示例
                </button>
            </div>
            
            <div id="claims_text_message" style="display:none; margin-top: 20px; padding: 15px; border-radius: 8px;"></div>
            
            <!-- 分析结果区域 -->
            <div id="claims_text_results" style="display:none; margin-top: 30px;">
                <!-- 统计信息 -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 25px;">
                    <div class="stat-card">
                        <div class="stat-label">总权利要求数</div>
                        <div class="stat-value" id="claims_text_stat_total">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">独立权利要求</div>
                        <div class="stat-value" id="claims_text_stat_independent">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">从属权利要求</div>
                        <div class="stat-value" id="claims_text_stat_dependent">0</div>
                    </div>
                </div>
                
                <!-- 权利要求列表 -->
                <div style="background: var(--surface-color); border: 1px solid var(--border-color); border-radius: 12px; padding: 25px; margin-bottom: 25px;">
                    <h4>
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="vertical-align: middle; margin-right: 6px;"><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect></svg>
                        权利要求列表
                    </h4>
                    <div id="claims_text_list"></div>
                </div>
                
                <!-- 可视化区域 -->
                <div style="background: var(--surface-color); border: 1px solid var(--border-color); border-radius: 12px; padding: 25px;">
                    <h4>
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="vertical-align: middle; margin-right: 6px;"><line x1="18" y1="20" x2="18" y2="10"></line><line x1="12" y1="20" x2="12" y2="4"></line><line x1="6" y1="20" x2="6" y2="14"></line></svg>
                        权利要求引证关系图
                    </h4>
                    <div style="display: flex; gap: 15px; align-items: center; margin-bottom: 20px; flex-wrap: wrap;">
                        <label for="claims_text_viz_style">可视化样式:</label>
                        <select id="claims_text_viz_style">
                            <option value="tree">树状图</option>
                            <option value="network">网络图</option>
                            <option value="radial">径向图</option>
                        </select>
                        
                        <div id="claims_text_tree_spread" style="display: flex; gap: 10px; align-items: center;">
                            <label for="claims_text_spread_slider">散开程度:</label>
                            <input type="range" id="claims_text_spread_slider" min="0.5" max="2.5" step="0.1" value="1.0" style="width: 120px;">
                            <span id="claims_text_spread_value">1.0x</span>
                        </div>
                        
                        <button id="claims_text_zoom_in" class="small-button" title="放大">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path><line x1="11" y1="8" x2="11" y2="14"></line><line x1="8" y1="11" x2="14" y2="11"></line></svg>
                        </button>
                        <button id="claims_text_zoom_out" class="small-button" title="缩小">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path><line x1="8" y1="11" x2="14" y2="11"></line></svg>
                        </button>
                        <button id="claims_text_zoom_reset" class="small-button" title="重置">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path><path d="M21 3v5h-5"></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path><path d="M3 21v-5h5"></path></svg>
                        </button>
                        <button id="claims_text_center" class="small-button" title="居中">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><circle cx="12" cy="12" r="3"></circle></svg>
                        </button>
                        <button id="claims_text_screenshot" class="small-button" title="截图">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path><circle cx="12" cy="13" r="4"></circle></svg>
                        </button>
                    </div>
                    
                    <div id="claims_text_visualization" style="width: 100%; height: 600px; border: 1px solid var(--border-color); border-radius: 8px; background: white;"></div>
                </div>
            </div>
        </div>
    </div>
    <!-- 文本输入分析页面结束 -->
    
</div>

    </div>
</div>

<!-- Note: This component is loaded dynamically by frontend/index.html -->
<!-- All required scripts are loaded in the main HTML file -->
<!-- No additional scripts needed here -->
<!-- 功能六增强脚本 -->
<script src="../js/patentTemplate.js"></script>
<script src="../js/patentChat.js"></script>
<script src="../js/main.js?v=20260206"></script>
<!-- 功能六：新标签页打开专利详情 - 绿色主题 + 左侧导航 + 复制按钮 -->
<script src="../js/patentDetailNewTab.js?v=20260204"></script>

<!-- 新增：专利附图弹窗组件 -->
<div id="drawings_modal" class="modal" style="display: none;">
    <div class="modal-content" style="max-width: 90vw; max-height: 90vh; overflow: auto;">
        <div class="modal-header">
            <h3 id="drawings_modal_title">专利附图</h3>
            <button class="close-modal" onclick="closeDrawingsModal()">&times;</button>
        </div>
        <div class="modal-body">
            <div id="drawings_loading" style="text-align: center; padding: 20px;">加载中...</div>
            <div id="drawings_container" style="display: none;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <div>
                        <span id="drawings_count"></span>
                    </div>
                    <div>
                        <button id="prev_drawing" class="small-button" onclick="showPrevDrawing()" disabled>上一张</button>
                        <button id="next_drawing" class="small-button" onclick="showNextDrawing()">下一张</button>
                    </div>
                </div>
                <div style="text-align: center;">
                    <img id="current_drawing" style="max-width: 100%; max-height: 70vh; object-fit: contain;" alt="专利附图">
                </div>
            </div>
        </div>
    </div>
</div>
