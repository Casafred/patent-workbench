<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äº¤äº’å¼æ ‡æ³¨æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 20px auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            border-bottom: 2px solid #4caf50;
            padding-bottom: 10px;
        }
        .info-box {
            background-color: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }
        .canvas-container {
            margin: 20px 0;
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 10px;
            background-color: #fafafa;
        }
        button {
            background-color: #4caf50;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            margin: 5px;
        }
        button:hover {
            background-color: #45a049;
        }
        .legend {
            display: flex;
            gap: 20px;
            margin: 15px 0;
            flex-wrap: wrap;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 3px;
            border: 2px solid #333;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¨ äº¤äº’å¼æ ‡æ³¨ç³»ç»Ÿæµ‹è¯•</h1>
        
        <div class="info-box">
            <strong>ğŸ’¡ äº¤äº’æç¤º:</strong><br>
            â€¢ <strong>æ‹–åŠ¨æ ‡æ³¨æ¡†</strong>ï¼šç‚¹å‡»å¹¶æ‹–åŠ¨ç»¿è‰²/è“è‰²/æ©™è‰²æ¡†<br>
            â€¢ <strong>åŒå‡»æ ‡æ³¨æ¡†</strong>ï¼šç¼–è¾‘éƒ¨ä»¶åç§°<br>
            â€¢ <strong>é¼ æ ‡æ‚¬åœ</strong>ï¼šæŸ¥çœ‹é¢œè‰²å˜åŒ–æ•ˆæœ<br>
            â€¢ <strong>ç‚¹å‡»ç©ºç™½</strong>ï¼šå–æ¶ˆé€‰ä¸­
        </div>
        
        <div class="legend">
            <div class="legend-item">
                <div class="legend-color" style="background-color: #4caf50;"></div>
                <span>ç»¿è‰² = æ™®é€šæ ‡æ³¨</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #2196f3;"></div>
                <span>è“è‰² = é€‰ä¸­çŠ¶æ€</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #ff9800;"></div>
                <span>æ©™è‰² = é¼ æ ‡æ‚¬åœ</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #f44336;"></div>
                <span>çº¢ç‚¹ = è¯†åˆ«ä½ç½®</span>
            </div>
        </div>
        
        <div>
            <button onclick="exportImage()">ğŸ“¥ å¯¼å‡ºå›¾ç‰‡</button>
            <button onclick="resetAnnotations()">ğŸ”„ é‡ç½®ä½ç½®</button>
            <button onclick="showAnnotationData()">ğŸ“Š æŸ¥çœ‹æ•°æ®</button>
        </div>
        
        <div class="canvas-container">
            <canvas id="test_canvas" style="width: 100%; border-radius: 4px;"></canvas>
        </div>
        
        <div id="data_display" style="margin-top: 20px; padding: 15px; background-color: #f5f5f5; border-radius: 4px; display: none;">
            <h3>æ ‡æ³¨æ•°æ®</h3>
            <pre id="data_content" style="background-color: white; padding: 10px; border-radius: 4px; overflow-x: auto;"></pre>
        </div>
    </div>
    
    <script src="frontend/js/drawingMarkerInteractive.js"></script>
    <script>
        // æ¨¡æ‹Ÿæµ‹è¯•æ•°æ®
        const testImageUrl = 'tests/test patent pic.png';
        
        const testDetectedNumbers = [
            { number: '21', x: 313, y: 78, confidence: 66.6 },
            { number: '20', x: 89, y: 88, confidence: 66.4 },
            { number: '19', x: 200, y: 88, confidence: 66.7 },
            { number: '11', x: 626, y: 173, confidence: 66.2 },
            { number: '10', x: 662, y: 199, confidence: 66.0 }
        ];
        
        const testReferenceMap = {
            '10': 'å¤–å£³',
            '11': 'ç”µæœº',
            '19': 'é½¿è½®',
            '20': 'è½´æ‰¿',
            '21': 'èºæ “'
        };
        
        // åˆ›å»ºäº¤äº’å¼æ ‡æ³¨å®ä¾‹
        let marker = null;
        
        // åˆå§‹åŒ–
        function init() {
            marker = new InteractiveDrawingMarker(
                'test_canvas',
                testImageUrl,
                testDetectedNumbers,
                testReferenceMap
            );
        }
        
        // å¯¼å‡ºå›¾ç‰‡
        function exportImage() {
            if (!marker) return;
            const imageData = marker.exportImage();
            const link = document.createElement('a');
            link.download = 'test_annotated.png';
            link.href = imageData;
            link.click();
            alert('å›¾ç‰‡å·²å¯¼å‡ºï¼');
        }
        
        // é‡ç½®æ ‡æ³¨ä½ç½®
        function resetAnnotations() {
            if (!marker) return;
            marker.initializeAnnotations();
            marker.render();
            alert('æ ‡æ³¨ä½ç½®å·²é‡ç½®ï¼');
        }
        
        // æ˜¾ç¤ºæ ‡æ³¨æ•°æ®
        function showAnnotationData() {
            if (!marker) return;
            const data = marker.exportAnnotations();
            const dataDisplay = document.getElementById('data_display');
            const dataContent = document.getElementById('data_content');
            dataContent.textContent = JSON.stringify(data, null, 2);
            dataDisplay.style.display = 'block';
        }
        
        // é¡µé¢åŠ è½½ååˆå§‹åŒ–
        window.addEventListener('load', init);
    </script>
</body>
</html>
