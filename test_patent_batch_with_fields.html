<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŠŸèƒ½å…­å¢å¼º - æ‰¹é‡çˆ¬å–ä¸å­—æ®µé€‰æ‹©</title>
    <link rel="stylesheet" href="frontend/css/main.css">
    <link rel="stylesheet" href="frontend/css/components/patent-config.css">
    <link rel="stylesheet" href="frontend/css/components/field-selector.css">
    <link rel="stylesheet" href="frontend/css/components/patent-timeline.css">
    <style>
        body {
            padding: 20px;
            font-family: 'Noto Sans SC', Arial, sans-serif;
            background: #f5f7fa;
        }
        .page-header {
            background: white;
            padding: 24px;
            border-radius: 8px;
            margin-bottom: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        .page-header h1 {
            margin: 0 0 8px 0;
            color: #2c3e50;
            font-size: 24px;
        }
        .page-header p {
            margin: 0;
            color: #666;
            font-size: 14px;
        }
        .test-section {
            background: white;
            margin-bottom: 24px;
            padding: 24px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        .test-section h2 {
            margin-top: 0;
            color: #4a6cf7;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
    </style>
</head>
<body>
    <div class="page-header">
        <h1>ğŸš€ åŠŸèƒ½å…­å¢å¼ºç‰ˆ - æ‰¹é‡ä¸“åˆ©çˆ¬å–</h1>
        <p>æ”¯æŒå­—æ®µé€‰æ‹©ã€äº‹ä»¶æ—¶é—´è½´å±•ç¤ºç­‰é«˜çº§åŠŸèƒ½</p>
    </div>
    
    <!-- æ‰¹é‡çˆ¬å–é…ç½® -->
    <div class="test-section">
        <h2>
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
            </svg>
            æ‰¹é‡çˆ¬å–é…ç½®
        </h2>
        
        <div class="patent-batch-config-grid">
            <!-- å·¦ä¾§ï¼šä¸“åˆ©å·è¾“å…¥ -->
            <div class="patent-input-section">
                <label for="patent_numbers_input">ä¸“åˆ©å·åˆ—è¡¨ï¼š</label>
                <div class="patent-input-wrapper">
                    <textarea id="patent_numbers_input" rows="8" placeholder="è¯·è¾“å…¥ä¸“åˆ©å·ï¼Œç”¨æ¢è¡Œç¬¦æˆ–ç©ºæ ¼åˆ†éš”ï¼ˆæœ€å¤š50ä¸ªï¼‰">US12390907B2
CN104154208B</textarea>
                </div>
                <div class="patent-input-footer">
                    <span id="patent_count_display">ä¸“åˆ©å·æ•°é‡ï¼š2/50</span>
                    <button id="clear_patent_input_btn" class="small-button delete-button">æ¸…ç©º</button>
                </div>
            </div>
            
            <!-- å³ä¾§ï¼šåŸºç¡€é…ç½® -->
            <div class="patent-config-section">
                <div class="config-item-compact">
                    <label for="patent_template_selector">è§£è¯»æ¨¡æ¿ï¼š</label>
                    <select id="patent_template_selector">
                        <option>é»˜è®¤æ¨¡æ¿</option>
                    </select>
                </div>
                
                <div class="config-item-compact">
                    <label for="patent_batch_model_selector">è§£è¯»æ¨¡å‹ï¼š</label>
                    <select id="patent_batch_model_selector">
                        <option value="GLM-4-Flash">GLM-4-Flashï¼ˆæ¨èï¼‰</option>
                    </select>
                </div>
            </div>
        </div>
    </div>

    
    <!-- å­—æ®µé€‰æ‹©å™¨ -->
    <div class="test-section">
        <h2>
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                <path d="M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v13.5a.5.5 0 0 1-.777.416L8 13.101l-5.223 2.815A.5.5 0 0 1 2 15.5V2zm2-1a1 1 0 0 0-1 1v12.566l4.723-2.482a.5.5 0 0 1 .554 0L13 14.566V2a1 1 0 0 0-1-1H4z"/>
                <path d="M4.268 3A2 2 0 0 1 6 2h4a2 2 0 0 1 1.732 1H4.268z"/>
            </svg>
            çˆ¬å–å­—æ®µé€‰æ‹©
        </h2>
        
        <div class="field-selector-container">
            <div class="field-selector-header">
                <div class="field-selector-title">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                        <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                        <path d="M10.97 4.97a.235.235 0 0 0-.02.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-1.071-1.05z"/>
                    </svg>
                    é€‰æ‹©è¦çˆ¬å–çš„å­—æ®µ
                </div>
                <div class="field-selector-actions">
                    <button class="field-selector-btn" onclick="selectAllOptionalFields()">å…¨é€‰å¯é€‰</button>
                    <button class="field-selector-btn" onclick="deselectAllOptionalFields()">å–æ¶ˆå…¨é€‰</button>
                    <button class="field-selector-btn" onclick="selectRecommendedFields()">æ¨èé…ç½®</button>
                </div>
            </div>
            
            <!-- åŸºç¡€å­—æ®µï¼ˆå¿…é€‰ï¼‰ -->
            <div class="field-group">
                <div class="field-group-title">
                    ğŸ“‹ åŸºç¡€ä¿¡æ¯
                    <span class="field-group-badge required">å¿…é€‰</span>
                </div>
                <div class="field-options-grid">
                    <div class="field-option disabled checked">
                        <input type="checkbox" checked disabled>
                        <span class="field-option-label">
                            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 16 16">
                                <path d="M4 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H4zm0 1h8a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1z"/>
                            </svg>
                            ä¸“åˆ©å·
                        </span>
                    </div>
                    <div class="field-option disabled checked">
                        <input type="checkbox" checked disabled>
                        <span class="field-option-label">æ ‡é¢˜</span>
                    </div>
                    <div class="field-option disabled checked">
                        <input type="checkbox" checked disabled>
                        <span class="field-option-label">æ‘˜è¦</span>
                    </div>
                    <div class="field-option disabled checked">
                        <input type="checkbox" checked disabled>
                        <span class="field-option-label">å‘æ˜äºº</span>
                    </div>
                    <div class="field-option disabled checked">
                        <input type="checkbox" checked disabled>
                        <span class="field-option-label">ç”³è¯·äºº</span>
                    </div>
                    <div class="field-option disabled checked">
                        <input type="checkbox" checked disabled>
                        <span class="field-option-label">ç”³è¯·æ—¥æœŸ</span>
                    </div>
                    <div class="field-option disabled checked">
                        <input type="checkbox" checked disabled>
                        <span class="field-option-label">å…¬å¼€æ—¥æœŸ</span>
                    </div>
                    <div class="field-option disabled checked">
                        <input type="checkbox" checked disabled>
                        <span class="field-option-label">æƒåˆ©è¦æ±‚</span>
                    </div>
                </div>
            </div>
            
            <!-- åˆ†ç±»ä¸é¢†åŸŸ -->
            <div class="field-group">
                <div class="field-group-title">
                    ğŸ·ï¸ åˆ†ç±»ä¸é¢†åŸŸ
                    <span class="field-group-badge">å¯é€‰</span>
                </div>
                <div class="field-options-grid">
                    <div class="field-option" onclick="toggleField(this)">
                        <input type="checkbox" id="field_classifications" checked>
                        <span class="field-option-label">CPCåˆ†ç±»</span>
                        <span class="field-option-info">æ¨è</span>
                    </div>
                    <div class="field-option" onclick="toggleField(this)">
                        <input type="checkbox" id="field_landscapes" checked>
                        <span class="field-option-label">æŠ€æœ¯é¢†åŸŸ</span>
                        <span class="field-option-info">æ¨è</span>
                    </div>
                    <div class="field-option" onclick="toggleField(this)">
                        <input type="checkbox" id="field_priority_date" checked>
                        <span class="field-option-label">ä¼˜å…ˆæƒæ—¥æœŸ</span>
                    </div>
                </div>
            </div>
            
            <!-- åŒæ—ä¿¡æ¯ -->
            <div class="field-group">
                <div class="field-group-title">
                    ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ åŒæ—ä¿¡æ¯
                    <span class="field-group-badge">å¯é€‰</span>
                </div>
                <div class="field-options-grid">
                    <div class="field-option" onclick="toggleField(this)">
                        <input type="checkbox" id="field_family_id">
                        <span class="field-option-label">åŒæ—ID</span>
                    </div>
                    <div class="field-option" onclick="toggleField(this)">
                        <input type="checkbox" id="field_family_applications">
                        <span class="field-option-label">åŒæ—ç”³è¯·</span>
                        <span class="field-option-info">è€—æ—¶</span>
                    </div>
                    <div class="field-option" onclick="toggleField(this)">
                        <input type="checkbox" id="field_country_status">
                        <span class="field-option-label">å›½å®¶çŠ¶æ€</span>
                    </div>
                </div>
            </div>
            
            <!-- å¼•ç”¨ä¿¡æ¯ -->
            <div class="field-group">
                <div class="field-group-title">
                    ğŸ“š å¼•ç”¨ä¿¡æ¯
                    <span class="field-group-badge">å¯é€‰</span>
                </div>
                <div class="field-options-grid">
                    <div class="field-option" onclick="toggleField(this)">
                        <input type="checkbox" id="field_patent_citations">
                        <span class="field-option-label">å¼•ç”¨ä¸“åˆ©</span>
                    </div>
                    <div class="field-option" onclick="toggleField(this)">
                        <input type="checkbox" id="field_cited_by">
                        <span class="field-option-label">è¢«å¼•ç”¨ä¸“åˆ©</span>
                        <span class="field-option-info">è€—æ—¶</span>
                    </div>
                </div>
            </div>
            
            <!-- æ³•å¾‹ä¸äº‹ä»¶ -->
            <div class="field-group">
                <div class="field-group-title">
                    âš–ï¸ æ³•å¾‹ä¸äº‹ä»¶
                    <span class="field-group-badge">å¯é€‰</span>
                </div>
                <div class="field-options-grid">
                    <div class="field-option" onclick="toggleField(this)">
                        <input type="checkbox" id="field_legal_events">
                        <span class="field-option-label">æ³•å¾‹äº‹ä»¶</span>
                        <span class="field-option-info">æ¨è</span>
                    </div>
                    <div class="field-option" onclick="toggleField(this)">
                        <input type="checkbox" id="field_external_links">
                        <span class="field-option-label">å¤–éƒ¨é“¾æ¥</span>
                    </div>
                </div>
            </div>
            
            <!-- é™„åŠ å†…å®¹ -->
            <div class="field-group">
                <div class="field-group-title">
                    ğŸ“„ é™„åŠ å†…å®¹
                    <span class="field-group-badge">å¯é€‰</span>
                </div>
                <div class="field-options-grid">
                    <div class="field-option" onclick="toggleField(this)">
                        <input type="checkbox" id="field_description">
                        <span class="field-option-label">è¯´æ˜ä¹¦</span>
                        <span class="field-option-info">è€—æ—¶</span>
                    </div>
                    <div class="field-option" onclick="toggleField(this)">
                        <input type="checkbox" id="field_drawings">
                        <span class="field-option-label">é™„å›¾</span>
                    </div>
                    <div class="field-option" onclick="toggleField(this)">
                        <input type="checkbox" id="field_similar_documents">
                        <span class="field-option-label">ç›¸ä¼¼æ–‡æ¡£</span>
                    </div>
                </div>
            </div>
            
            <!-- ç»Ÿè®¡ä¿¡æ¯ -->
            <div class="field-selector-stats">
                <div class="field-selector-count">
                    å·²é€‰æ‹© <strong id="selected_fields_count">11</strong> ä¸ªå­—æ®µ
                    ï¼ˆåŸºç¡€ 8 + å¯é€‰ 3ï¼‰
                </div>
                <div style="color: #999; font-size: 11px;">
                    ğŸ’¡ æç¤ºï¼šé€‰æ‹©æ›´å¤šå­—æ®µä¼šå¢åŠ çˆ¬å–æ—¶é—´
                </div>
            </div>
            
            <!-- è­¦å‘Šä¿¡æ¯ -->
            <div class="field-selector-warning" id="field_warning" style="display: none;">
                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 16 16">
                    <path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/>
                </svg>
                é€‰æ‹©äº†è¾ƒå¤šè€—æ—¶å­—æ®µï¼Œé¢„è®¡çˆ¬å–æ—¶é—´ä¼šæ˜¾è‘—å¢åŠ 
            </div>
        </div>
        
        <!-- æ“ä½œæŒ‰é’® -->
        <div style="margin-top: 16px; text-align: center;">
            <button class="small-button primary-btn" onclick="startBatchCrawl()" style="padding: 10px 24px; font-size: 14px;">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16" style="vertical-align: middle; margin-right: 6px;">
                    <path d="M11.534 7h3.932a.25.25 0 0 1 .192.41l-1.966 2.36a.25.25 0 0 1-.384 0l-1.966-2.36a.25.25 0 0 1 .192-.41zm-11 2h3.932a.25.25 0 0 0 .192-.41L2.692 6.23a.25.25 0 0 0-.384 0L.342 8.59A.25.25 0 0 0 .534 9z"/>
                    <path fill-rule="evenodd" d="M8 3c-1.552 0-2.94.707-3.857 1.818a.5.5 0 1 1-.771-.636A6.002 6.002 0 0 1 13.917 7H12.9A5.002 5.002 0 0 0 8 3zM3.1 9a5.002 5.002 0 0 0 8.757 2.182.5.5 0 1 1 .771.636A6.002 6.002 0 0 1 2.083 9H3.1z"/>
                </svg>
                å¼€å§‹æ‰¹é‡çˆ¬å–
            </button>
        </div>
    </div>

    
    <!-- äº‹ä»¶æ—¶é—´è½´å±•ç¤º -->
    <div class="test-section">
        <h2>
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                <path d="M8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71V3.5z"/>
                <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm7-8A7 7 0 1 1 1 8a7 7 0 0 1 14 0z"/>
            </svg>
            ä¸“åˆ©äº‹ä»¶æ—¶é—´è½´
        </h2>
        
        <div class="patent-timeline-container">
            <div class="patent-timeline" id="patent_timeline">
                <!-- äº‹ä»¶1: ç”³è¯·æäº¤ -->
                <div class="timeline-event critical">
                    <div class="timeline-event-content">
                        <div class="timeline-event-date">
                            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 16 16">
                                <path d="M11 6.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1z"/>
                                <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1z"/>
                            </svg>
                            2018-07-13
                        </div>
                        <div class="timeline-event-title">ç”³è¯·æäº¤</div>
                        <div class="timeline-event-code">filed</div>
                        <div class="timeline-event-description">
                            Application filed by Stanley Black and Decker Inc
                        </div>
                    </div>
                    <div class="timeline-event-node"></div>
                    <div class="timeline-event-connector"></div>
                </div>
                
                <!-- äº‹ä»¶2: å…¬å¼€ -->
                <div class="timeline-event critical">
                    <div class="timeline-event-content">
                        <div class="timeline-event-date">
                            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 16 16">
                                <path d="M11 6.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1z"/>
                                <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1z"/>
                            </svg>
                            2021-09-02
                        </div>
                        <div class="timeline-event-title">å…¬å¼€å‘å¸ƒ</div>
                        <div class="timeline-event-code">publication</div>
                        <div class="timeline-event-description">
                            Publication of US20210268630A1
                        </div>
                    </div>
                    <div class="timeline-event-node"></div>
                    <div class="timeline-event-connector"></div>
                </div>
                
                <!-- äº‹ä»¶3: è½¬è®© -->
                <div class="timeline-event">
                    <div class="timeline-event-content">
                        <div class="timeline-event-date">
                            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 16 16">
                                <path d="M11 6.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1z"/>
                                <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1z"/>
                            </svg>
                            2024-12-10
                        </div>
                        <div class="timeline-event-title">æƒåˆ©è½¬è®©</div>
                        <div class="timeline-event-code">reassignment</div>
                        <div class="timeline-event-description">
                            Assigned to STANLEY BLACK & DECKER INC.<br>
                            <small style="color: #999;">ASSIGNMENT OF ASSIGNORS INTEREST</small>
                        </div>
                    </div>
                    <div class="timeline-event-node"></div>
                    <div class="timeline-event-connector"></div>
                </div>
                
                <!-- äº‹ä»¶4: æˆæƒ -->
                <div class="timeline-event critical">
                    <div class="timeline-event-content">
                        <div class="timeline-event-date">
                            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 16 16">
                                <path d="M11 6.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1z"/>
                                <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1z"/>
                            </svg>
                            2025-08-19
                        </div>
                        <div class="timeline-event-title">ä¸“åˆ©æˆæƒ</div>
                        <div class="timeline-event-code">granted</div>
                        <div class="timeline-event-description">
                            Application granted - Publication of US12390907B2
                        </div>
                    </div>
                    <div class="timeline-event-node"></div>
                    <div class="timeline-event-connector"></div>
                </div>
                
                <!-- äº‹ä»¶5: å½“å‰çŠ¶æ€ -->
                <div class="timeline-event critical">
                    <div class="timeline-event-content">
                        <div class="timeline-event-date">
                            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 16 16">
                                <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"/>
                            </svg>
                            å½“å‰
                        </div>
                        <div class="timeline-event-title">ä¸“åˆ©æœ‰æ•ˆ</div>
                        <div class="timeline-event-code">Active</div>
                        <div class="timeline-event-description">
                            ä¸“åˆ©å½“å‰çŠ¶æ€ï¼šæœ‰æ•ˆ<br>
                            <small style="color: #999;">åˆ°æœŸæ—¥æœŸï¼š2040-12-23</small>
                        </div>
                    </div>
                    <div class="timeline-event-node"></div>
                </div>
            </div>
        </div>
        
        <div style="margin-top: 16px; padding: 12px; background: #e3f2fd; border-radius: 6px; font-size: 13px; color: #1976d2;">
            <strong>ğŸ’¡ æç¤ºï¼š</strong> æ—¶é—´è½´å±•ç¤ºäº†ä¸“åˆ©ä»ç”³è¯·åˆ°å½“å‰çš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸï¼Œå…³é”®äº‹ä»¶ç”¨è“è‰²èŠ‚ç‚¹æ ‡è®°
        </div>
    </div>
    
    <script>
        // å­—æ®µé€‰æ‹©å™¨é€»è¾‘
        function toggleField(element) {
            if (element.classList.contains('disabled')) return;
            
            const checkbox = element.querySelector('input[type="checkbox"]');
            checkbox.checked = !checkbox.checked;
            
            if (checkbox.checked) {
                element.classList.add('checked');
            } else {
                element.classList.remove('checked');
            }
            
            updateFieldCount();
            checkWarning();
        }
        
        function updateFieldCount() {
            const baseFields = 8; // åŸºç¡€å­—æ®µæ•°é‡
            const optionalFields = document.querySelectorAll('.field-option:not(.disabled) input[type="checkbox"]:checked').length;
            const total = baseFields + optionalFields;
            
            document.getElementById('selected_fields_count').textContent = total;
            document.getElementById('selected_fields_count').parentElement.innerHTML = 
                `å·²é€‰æ‹© <strong id="selected_fields_count">${total}</strong> ä¸ªå­—æ®µï¼ˆåŸºç¡€ ${baseFields} + å¯é€‰ ${optionalFields}ï¼‰`;
        }
        
        function checkWarning() {
            const timeConsumingFields = [
                'field_family_applications',
                'field_cited_by',
                'field_description'
            ];
            
            const selectedTimeConsuming = timeConsumingFields.filter(id => 
                document.getElementById(id)?.checked
            ).length;
            
            const warning = document.getElementById('field_warning');
            if (selectedTimeConsuming >= 2) {
                warning.style.display = 'flex';
            } else {
                warning.style.display = 'none';
            }
        }
        
        function selectAllOptionalFields() {
            document.querySelectorAll('.field-option:not(.disabled)').forEach(option => {
                const checkbox = option.querySelector('input[type="checkbox"]');
                checkbox.checked = true;
                option.classList.add('checked');
            });
            updateFieldCount();
            checkWarning();
        }
        
        function deselectAllOptionalFields() {
            document.querySelectorAll('.field-option:not(.disabled)').forEach(option => {
                const checkbox = option.querySelector('input[type="checkbox"]');
                checkbox.checked = false;
                option.classList.remove('checked');
            });
            updateFieldCount();
            checkWarning();
        }
        
        function selectRecommendedFields() {
            // å…ˆå–æ¶ˆæ‰€æœ‰å¯é€‰å­—æ®µ
            deselectAllOptionalFields();
            
            // é€‰æ‹©æ¨èå­—æ®µ
            const recommendedFields = [
                'field_classifications',
                'field_landscapes',
                'field_priority_date',
                'field_legal_events'
            ];
            
            recommendedFields.forEach(id => {
                const checkbox = document.getElementById(id);
                if (checkbox) {
                    checkbox.checked = true;
                    checkbox.closest('.field-option').classList.add('checked');
                }
            });
            
            updateFieldCount();
            checkWarning();
        }
        
        function getSelectedFields() {
            const fields = {
                // åŸºç¡€å­—æ®µï¼ˆå§‹ç»ˆåŒ…å«ï¼‰
                basic: true,
                title: true,
                abstract: true,
                inventors: true,
                assignees: true,
                application_date: true,
                publication_date: true,
                claims: true,
                
                // å¯é€‰å­—æ®µ
                classifications: document.getElementById('field_classifications')?.checked || false,
                landscapes: document.getElementById('field_landscapes')?.checked || false,
                priority_date: document.getElementById('field_priority_date')?.checked || false,
                family_id: document.getElementById('field_family_id')?.checked || false,
                family_applications: document.getElementById('field_family_applications')?.checked || false,
                country_status: document.getElementById('field_country_status')?.checked || false,
                patent_citations: document.getElementById('field_patent_citations')?.checked || false,
                cited_by: document.getElementById('field_cited_by')?.checked || false,
                legal_events: document.getElementById('field_legal_events')?.checked || false,
                external_links: document.getElementById('field_external_links')?.checked || false,
                description: document.getElementById('field_description')?.checked || false,
                drawings: document.getElementById('field_drawings')?.checked || false,
                similar_documents: document.getElementById('field_similar_documents')?.checked || false
            };
            
            return fields;
        }
        
        function startBatchCrawl() {
            const patentNumbers = document.getElementById('patent_numbers_input').value
                .split(/[\n\s,]+/)
                .filter(n => n.trim());
            
            if (patentNumbers.length === 0) {
                alert('è¯·è¾“å…¥è‡³å°‘ä¸€ä¸ªä¸“åˆ©å·');
                return;
            }
            
            const selectedFields = getSelectedFields();
            const selectedCount = Object.values(selectedFields).filter(v => v === true).length;
            
            console.log('å¼€å§‹æ‰¹é‡çˆ¬å–:');
            console.log('ä¸“åˆ©æ•°é‡:', patentNumbers.length);
            console.log('é€‰æ‹©å­—æ®µ:', selectedCount);
            console.log('å­—æ®µè¯¦æƒ…:', selectedFields);
            
            alert(`å‡†å¤‡çˆ¬å– ${patentNumbers.length} ä¸ªä¸“åˆ©\nå·²é€‰æ‹© ${selectedCount} ä¸ªå­—æ®µ\n\nå®é™…çˆ¬å–åŠŸèƒ½éœ€è¦è¿æ¥åç«¯API`);
        }
        
        // åˆå§‹åŒ–
        updateFieldCount();
        checkWarning();
    </script>
</body>
</html>
