<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŠŸèƒ½å…«äº¤äº’å¼æ ‡æ³¨æµ‹è¯• v4.0</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            padding: 30px;
        }
        
        h1 {
            color: #333;
            margin-bottom: 10px;
            font-size: 28px;
        }
        
        .version {
            color: #666;
            font-size: 14px;
            margin-bottom: 20px;
        }
        
        .improvements {
            background: #f0f9ff;
            border-left: 4px solid #0ea5e9;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 4px;
        }
        
        .improvements h3 {
            color: #0369a1;
            margin-bottom: 10px;
            font-size: 16px;
        }
        
        .improvements ul {
            list-style: none;
            padding-left: 0;
        }
        
        .improvements li {
            padding: 5px 0;
            color: #0c4a6e;
        }
        
        .improvements li:before {
            content: "âœ“ ";
            color: #10b981;
            font-weight: bold;
            margin-right: 8px;
        }
        
        .canvas-container {
            background: #f5f5f5;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        canvas {
            border: 2px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
            transition: transform 0.2s;
            display: block;
            margin: 0 auto;
        }
        
        canvas:hover {
            transform: scale(1.02);
            border-color: #FF5722;
        }
        
        .instructions {
            background: #fef3c7;
            border-left: 4px solid #f59e0b;
            padding: 15px;
            margin-top: 20px;
            border-radius: 4px;
        }
        
        .instructions h3 {
            color: #92400e;
            margin-bottom: 10px;
            font-size: 16px;
        }
        
        .instructions p {
            color: #78350f;
            line-height: 1.6;
        }
        
        .hint {
            text-align: center;
            color: #666;
            font-size: 14px;
            margin-top: 10px;
            font-style: italic;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¨ åŠŸèƒ½å…«äº¤äº’å¼æ ‡æ³¨æµ‹è¯•</h1>
        <div class="version">ç‰ˆæœ¬ v4.0 - é«˜æ¸…æ˜¾ç¤º + çº¯çº¿æ¡æ ‡æ³¨ + ä¸“ä¸šå¼¹çª—</div>
        
        <div class="improvements">
            <h3>æœ¬æ¬¡æ”¹è¿›ï¼š</h3>
            <ul>
                <li>ä½¿ç”¨é«˜æ¸…åŸå›¾ä½œä¸ºå±•ç¤ºåŸºåº•ï¼Œå›¾ç‰‡ä¸å†æ¨¡ç³Š</li>
                <li>ç§»é™¤çº¢ç‚¹æ ‡è¯†ï¼Œç›´æ¥ç”¨çº¿æ¡è¿æ¥æ ‡æ³¨</li>
                <li>æ ‡æ³¨æ–‡å­—æ— èƒŒæ™¯æ¡†ï¼Œä½¿ç”¨é†’ç›®çš„æ©™çº¢è‰²</li>
                <li>å¤§å¼¹çª—æ”¯æŒç¼©æ”¾ï¼ˆ50%-500%ï¼‰å’Œæ‹–åŠ¨æŸ¥çœ‹</li>
                <li>é¼ æ ‡æ»šè½®ç¼©æ”¾ï¼Œæ‹–åŠ¨å¹³ç§»ï¼Œä¸“ä¸šå›¾ç‰‡æŸ¥çœ‹å™¨ä½“éªŒ</li>
            </ul>
        </div>
        
        <div class="canvas-container">
            <canvas id="testCanvas"></canvas>
            <div class="hint">ğŸ’¡ ç‚¹å‡»å›¾ç‰‡æ‰“å¼€å¤§å¼¹çª—æŸ¥çœ‹å®Œæ•´é™„å›¾</div>
        </div>
        
        <div class="instructions">
            <h3>ä½¿ç”¨è¯´æ˜ï¼š</h3>
            <p>
                <strong>ä¸»ç•Œé¢ï¼š</strong>æ˜¾ç¤ºé«˜æ¸…åŸå›¾ + æ ‡æ³¨ï¼ˆçº¿æ¡ + æ–‡å­—ï¼Œæ— çº¢ç‚¹ï¼Œæ— èƒŒæ™¯æ¡†ï¼‰<br>
                <strong>ç‚¹å‡»å›¾ç‰‡ï¼š</strong>æ‰“å¼€å¤§å¼¹çª—ï¼Œå¯ä»¥ç¼©æ”¾å’Œæ‹–åŠ¨æŸ¥çœ‹<br>
                <strong>å¼¹çª—æ“ä½œï¼š</strong><br>
                â€¢ é¼ æ ‡æ»šè½®ï¼šç¼©æ”¾å›¾ç‰‡ï¼ˆ50%-500%ï¼‰<br>
                â€¢ æ‹–åŠ¨é¼ æ ‡ï¼šå¹³ç§»æŸ¥çœ‹ä¸åŒä½ç½®<br>
                â€¢ å·¥å…·æ æŒ‰é’®ï¼šæ”¾å¤§ã€ç¼©å°ã€é‡ç½®ã€å…³é—­<br>
                â€¢ ç‚¹å‡»èƒŒæ™¯æˆ–æŒ‰ESCï¼šå…³é—­å¼¹çª—
            </p>
        </div>
    </div>
    
    <script src="js/drawingMarkerInteractive.js"></script>
    <script>
        // åˆ›å»ºæµ‹è¯•å›¾ç‰‡ï¼ˆæ¨¡æ‹Ÿä¸“åˆ©é™„å›¾ï¼‰
        function createTestImage() {
            const canvas = document.createElement('canvas');
            canvas.width = 1200;
            canvas.height = 900;
            const ctx = canvas.getContext('2d');
            
            // ç™½è‰²èƒŒæ™¯
            ctx.fillStyle = '#FFFFFF';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // ç»˜åˆ¶ä¸€äº›ç®€å•çš„æœºæ¢°éƒ¨ä»¶ç¤ºæ„å›¾
            ctx.strokeStyle = '#000000';
            ctx.lineWidth = 3;
            
            // åº•åº§
            ctx.fillStyle = '#E0E0E0';
            ctx.fillRect(300, 600, 600, 150);
            ctx.strokeRect(300, 600, 600, 150);
            
            // ç«‹æŸ±
            ctx.fillStyle = '#C0C0C0';
            ctx.fillRect(550, 300, 100, 300);
            ctx.strokeRect(550, 300, 100, 300);
            
            // æ—‹è½¬è‡‚
            ctx.fillStyle = '#A0A0A0';
            ctx.beginPath();
            ctx.moveTo(600, 350);
            ctx.lineTo(900, 250);
            ctx.lineTo(900, 300);
            ctx.lineTo(600, 400);
            ctx.closePath();
            ctx.fill();
            ctx.stroke();
            
            // å¤¹ç´§è£…ç½®
            ctx.fillStyle = '#808080';
            ctx.beginPath();
            ctx.arc(900, 275, 40, 0, Math.PI * 2);
            ctx.fill();
            ctx.stroke();
            
            // å›ºå®šèºæ “
            ctx.fillStyle = '#606060';
            ctx.beginPath();
            ctx.arc(350, 650, 15, 0, Math.PI * 2);
            ctx.fill();
            ctx.stroke();
            
            ctx.beginPath();
            ctx.arc(850, 650, 15, 0, Math.PI * 2);
            ctx.fill();
            ctx.stroke();
            
            // è¿æ¥ä»¶
            ctx.fillStyle = '#707070';
            ctx.fillRect(580, 320, 40, 40);
            ctx.strokeRect(580, 320, 40, 40);
            
            // æ·»åŠ åŸå§‹æ ‡è®°ï¼ˆæ¨¡æ‹Ÿä¸“åˆ©é™„å›¾ä¸Šçš„æ•°å­—ï¼‰
            ctx.font = 'bold 24px Arial';
            ctx.fillStyle = '#000000';
            
            // åœ¨å„ä¸ªéƒ¨ä»¶æ—è¾¹æ ‡æ³¨æ•°å­—
            ctx.fillText('1', 320, 680);  // åº•åº§
            ctx.fillText('2', 570, 450);  // ç«‹æŸ±
            ctx.fillText('3', 750, 300);  // æ—‹è½¬è‡‚
            ctx.fillText('10', 920, 280); // å¤¹ç´§è£…ç½®
            ctx.fillText('11', 360, 660); // å›ºå®šèºæ “
            ctx.fillText('12', 590, 345); // è¿æ¥ä»¶
            
            return canvas.toDataURL('image/png');
        }
        
        // æ¨¡æ‹ŸOCRè¯†åˆ«ç»“æœ
        const detectedNumbers = [
            { number: '1', x: 320, y: 680, confidence: 95, name: 'åº•åº§' },
            { number: '2', x: 570, y: 450, confidence: 92, name: 'ç«‹æŸ±' },
            { number: '3', x: 750, y: 300, confidence: 88, name: 'æ—‹è½¬è‡‚' },
            { number: '10', x: 920, y: 280, confidence: 90, name: 'å¤¹ç´§è£…ç½®' },
            { number: '11', x: 360, y: 660, confidence: 93, name: 'å›ºå®šèºæ “' },
            { number: '12', x: 590, y: 345, confidence: 91, name: 'è¿æ¥ä»¶' }
        ];
        
        // å‚è€ƒæ˜ å°„
        const referenceMap = {
            '1': 'åº•åº§',
            '2': 'ç«‹æŸ±',
            '3': 'æ—‹è½¬è‡‚',
            '10': 'å¤¹ç´§è£…ç½®',
            '11': 'å›ºå®šèºæ “',
            '12': 'è¿æ¥ä»¶'
        };
        
        // åˆ›å»ºäº¤äº’å¼æ ‡æ³¨
        const imageUrl = createTestImage();
        const marker = new InteractiveDrawingMarker(
            'testCanvas',
            imageUrl,
            detectedNumbers,
            referenceMap,
            {
                enableModal: true,
                fontSize: 18
            }
        );
        
        // ä¿å­˜åˆ°å…¨å±€
        window.interactiveMarkers = window.interactiveMarkers || [];
        window.interactiveMarkers.push(marker);
        
        console.log('âœ… äº¤äº’å¼æ ‡æ³¨åˆå§‹åŒ–å®Œæˆ');
        console.log('ğŸ“Š æ£€æµ‹åˆ°çš„æ ‡è®°:', detectedNumbers);
    </script>
</body>
</html>
