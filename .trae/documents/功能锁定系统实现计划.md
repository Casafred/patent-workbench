# 功能锁定系统实现计划

## 一、功能概述
实现一个功能锁定管理系统，允许超级管理员（你）锁定特定功能页。被锁定的功能页对普通用户显示半透明遮罩层，提示"功能优化升级中，暂不开放使用，如有需求请在公众号联系"。

## 二、实现方案

### 1. 后端实现

#### 1.1 创建功能锁定配置文件
- 文件路径：`backend/config/feature_locks.json`
- 存储被锁定的功能页ID列表

#### 1.2 创建功能锁定API路由
- 文件：`backend/routes/feature_lock.py`
- API端点：
  - `GET /api/feature-lock/status` - 获取所有功能锁定状态（公开）
  - `GET /api/feature-lock/admin/list` - 获取锁定列表（需超级管理员权限）
  - `POST /api/feature-lock/admin/toggle` - 切换功能锁定状态（需超级管理员权限）

#### 1.3 超级管理员验证
- 使用独立于普通管理员的密码验证
- 在session中标记超级管理员身份

### 2. 前端实现

#### 2.1 功能锁定管理页面
- 在现有管理员页面 `admin_manage.html` 添加新标签页"功能锁定"
- 显示所有功能页列表，支持勾选锁定/解锁
- 需要输入超级管理员密码才能进入此标签页

#### 2.2 主页面遮罩层
- 在 `frontend/index.html` 或 `js/main.js` 中：
  - 页面加载时调用API获取锁定状态
  - 为被锁定的功能页添加遮罩层
  - 遮罩层样式：半透明背景 + 提示文字 + 公众号二维码

### 3. 功能页列表
| ID | 功能名称 |
|---|---|
| instant_chat | 功能一：即时对话 |
| async_batch | 功能二：异步批处理 |
| large_batch | 功能三：大批量处理 |
| local_patent_lib | 功能四：本地专利库 |
| claims_comparison | 功能五：权利要求对比 |
| patent_batch | 功能六：批量专利查询 |
| claims_processor | 功能七：权利要求处理器 |
| drawing_marker | 功能八：附图标记功能 |
| pdf_ocr_reader | 功能九：PDF/OCR阅读器 |

## 三、文件修改清单

### 新建文件
1. `backend/config/feature_locks.json` - 锁定配置存储
2. `backend/routes/feature_lock.py` - API路由

### 修改文件
1. `backend/routes/__init__.py` - 注册新蓝图
2. `backend/templates/admin_manage.html` - 添加功能锁定管理标签页
3. `frontend/index.html` 或 `js/main.js` - 添加遮罩层逻辑

## 四、实现步骤

1. **后端基础**：创建配置文件和API路由
2. **前端管理界面**：在管理员页面添加功能锁定管理
3. **前端遮罩层**：实现锁定功能的遮罩显示
4. **测试验证**：确保功能正常工作