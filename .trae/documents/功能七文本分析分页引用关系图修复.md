## 问题分析

功能七的文本分析分页在生成引用关系图时，与Excel分析部分的图存在不一致，主要问题包括：

1. **渲染器不统一**：文本分析使用 `ClaimsVisualizationRenderer`，而Excel分析使用 `ClaimsD3TreeRenderer`
2. **交互体验差异**：文本分析的节点交互和工具提示可能与Excel分析不同
3. **箭头方向显示**：文本分析的引用箭头方向可能不明确
4. **切换显示状态问题**：切换显示状态时图表可能变成空白而不是刷新渲染

## 修复方案

### 1. 统一渲染器类

将文本分析部分的可视化渲染器改为使用与Excel分析相同的 `ClaimsD3TreeRenderer` 类，确保视觉风格和交互行为一致。

### 2. 修复渲染逻辑

修改 `renderClaimsTextVisualization` 函数，移除每次重新创建渲染器的逻辑，改为复用渲染器实例，确保状态正确保存。

### 3. 统一数据格式

确保 `createClaimsTextVizData` 函数生成的数据格式与 Excel 分析部分的 `claimsBuildVisualizationData` 函数一致，包括：
- 节点属性（id、claim_number、claim_text、claim_type等）
- 连接关系（source、target、type等）

### 4. 优化切换显示逻辑

确保在切换显示状态时，能够正确调用渲染器的 `render` 方法，而不是重新创建渲染器实例，避免图表变成空白。

### 5. 确保箭头方向正确

使用与Excel分析相同的箭头标记定义，确保引用关系的方向清晰可见。

## 实现步骤

1. 修改 `renderClaimsTextVisualization` 函数，使用 `ClaimsD3TreeRenderer` 替代 `ClaimsVisualizationRenderer`
2. 调整渲染器实例的创建和复用逻辑
3. 优化 `createClaimsTextVizData` 函数，确保数据格式与Excel分析一致
4. 测试切换显示状态时的渲染效果
5. 确保引用箭头方向正确显示

## 预期效果

- 文本分析分页的引用关系图与Excel分析部分的图视觉风格一致
- 节点交互（悬停显示详细信息、点击查看完整内容）功能正常
- 引用箭头方向清晰可见
- 切换显示状态时图表能够正确刷新渲染，不会变成空白