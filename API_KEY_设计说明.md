# API Key è®¾è®¡è¯´æ˜

## ğŸ¯ è®¾è®¡ç†å¿µ

æœ¬é¡¹ç›®é‡‡ç”¨**ç”¨æˆ·è‡ªé…ç½® API Key** çš„è®¾è®¡ï¼Œè€Œä¸æ˜¯åœ¨æœåŠ¡å™¨ç¯å¢ƒå˜é‡ä¸­ç»Ÿä¸€é…ç½®ã€‚

---

## âœ… å½“å‰è®¾è®¡ï¼ˆæ¨èï¼‰

### å·¥ä½œæµç¨‹

1. **ç”¨æˆ·ç™»å½•** â†’ è¿›å…¥åº”ç”¨
2. **é…ç½® API Key** â†’ åœ¨é¡µé¢å³ä¸Šè§’çš„è®¾ç½®ä¸­è¾“å…¥è‡ªå·±çš„æ™ºè°±AI API Key
3. **API Key å­˜å‚¨** â†’ ä¿å­˜åœ¨æµè§ˆå™¨ localStorage ä¸­
4. **API è°ƒç”¨** â†’ é€šè¿‡è¯·æ±‚å¤´ `Authorization: Bearer <api_key>` å‘é€åˆ°åç«¯
5. **åç«¯å¤„ç†** â†’ ä»è¯·æ±‚å¤´è·å– API Keyï¼Œåˆ›å»º ZhipuAI å®¢æˆ·ç«¯

### ä»£ç å®ç°

**å‰ç«¯ï¼ˆfrontend/index.htmlï¼‰ï¼š**
```html
<div class="api-config-section">
    <input type="password" id="global_api_key_input" 
           placeholder="åœ¨æ­¤å¤„ç²˜è´´ä»¥å¯ç”¨æ‰€æœ‰åŠŸèƒ½">
</div>
```

**åç«¯ï¼ˆbackend/services/api_service.pyï¼‰ï¼š**
```python
def get_zhipu_client():
    auth_header = request.headers.get('Authorization')
    if not auth_header or not auth_header.startswith('Bearer '):
        return None, create_response(
            error="Authorization header with Bearer token is required.",
            status_code=401
        )
    api_key = auth_header.split(' ')[1]
    client = ZhipuAI(api_key=api_key)
    return client, None
```

---

## ğŸŒŸ ä¼˜åŠ¿

### 1. å®‰å…¨æ€§æ›´é«˜
- âœ… æ¯ä¸ªç”¨æˆ·ä½¿ç”¨è‡ªå·±çš„ API Key
- âœ… API Key ä¸å­˜å‚¨åœ¨æœåŠ¡å™¨
- âœ… ä¸ä¼šå› ä¸ºæœåŠ¡å™¨æ³„éœ²å¯¼è‡´æ‰€æœ‰ç”¨æˆ·çš„ API Key æš´éœ²

### 2. çµæ´»æ€§æ›´å¼º
- âœ… ç”¨æˆ·å¯ä»¥éšæ—¶æ›´æ¢è‡ªå·±çš„ API Key
- âœ… ä¸åŒç”¨æˆ·å¯ä»¥ä½¿ç”¨ä¸åŒçš„ API é…é¢
- âœ… ä¾¿äºç”¨æˆ·ç®¡ç†è‡ªå·±çš„ API ä½¿ç”¨æƒ…å†µ

### 3. æˆæœ¬æ§åˆ¶
- âœ… æ¯ä¸ªç”¨æˆ·æ‰¿æ‹…è‡ªå·±çš„ API è°ƒç”¨è´¹ç”¨
- âœ… æœåŠ¡æä¾›è€…ä¸éœ€è¦æ‰¿æ‹…æ‰€æœ‰ç”¨æˆ·çš„ API è´¹ç”¨
- âœ… é¿å…å•ä¸ª API Key è¢«æ»¥ç”¨

### 4. æ˜“äºæ‰©å±•
- âœ… æœªæ¥å¯ä»¥æ”¯æŒå¤šä¸ª AI æœåŠ¡å•†
- âœ… ç”¨æˆ·å¯ä»¥é€‰æ‹©ä½¿ç”¨ä¸åŒçš„ API Key
- âœ… ä¾¿äºå®ç°å¤šç§Ÿæˆ·æ¶æ„

---

## âŒ ä¸æ¨èçš„è®¾è®¡ï¼ˆç¯å¢ƒå˜é‡é…ç½®ï¼‰

### é—®é¢˜

å¦‚æœåœ¨ç¯å¢ƒå˜é‡ä¸­é…ç½® `ZHIPUAI_API_KEY`ï¼š

1. **å®‰å…¨é£é™©**
   - âŒ æ‰€æœ‰ç”¨æˆ·å…±äº«åŒä¸€ä¸ª API Key
   - âŒ ä¸€æ—¦æ³„éœ²ï¼Œå½±å“æ‰€æœ‰ç”¨æˆ·
   - âŒ éš¾ä»¥è¿½è¸ªæ˜¯è°åœ¨ä½¿ç”¨ API

2. **æˆæœ¬é—®é¢˜**
   - âŒ æœåŠ¡æä¾›è€…æ‰¿æ‹…æ‰€æœ‰ API è°ƒç”¨è´¹ç”¨
   - âŒ å®¹æ˜“è¢«æ»¥ç”¨
   - âŒ éš¾ä»¥æ§åˆ¶æˆæœ¬

3. **çµæ´»æ€§å·®**
   - âŒ æ›´æ¢ API Key éœ€è¦é‡å¯æœåŠ¡
   - âŒ æ‰€æœ‰ç”¨æˆ·å—å½±å“
   - âŒ æ— æ³•å®ç°ä¸ªæ€§åŒ–é…ç½®

---

## ğŸ“‹ éƒ¨ç½²è¯´æ˜

### Render ç¯å¢ƒå˜é‡é…ç½®

**éœ€è¦é…ç½®ï¼š**
```
FLASK_SECRET_KEY = <è‡ªåŠ¨ç”Ÿæˆ>
PORT = 10000
```

**ä¸éœ€è¦é…ç½®ï¼š**
```
âŒ ZHIPUAI_API_KEY  # ç”¨æˆ·è‡ªè¡Œé…ç½®
```

### ç”¨æˆ·ä½¿ç”¨æµç¨‹

1. **è·å– API Key**
   - è®¿é—® https://open.bigmodel.cn/
   - æ³¨å†Œ/ç™»å½•è´¦å·
   - åœ¨æ§åˆ¶å°åˆ›å»º API Key

2. **é…ç½® API Key**
   - ç™»å½•åº”ç”¨
   - ç‚¹å‡»å³ä¸Šè§’è®¾ç½®æŒ‰é’® âš™ï¸
   - ç²˜è´´ API Key
   - ä¿å­˜

3. **å¼€å§‹ä½¿ç”¨**
   - API Key ä¼šè‡ªåŠ¨ç”¨äºæ‰€æœ‰ AI åŠŸèƒ½
   - ä¿å­˜åœ¨æµè§ˆå™¨æœ¬åœ°ï¼Œä¸‹æ¬¡è®¿é—®è‡ªåŠ¨åŠ è½½

---

## ğŸ”§ æŠ€æœ¯å®ç°

### å‰ç«¯å­˜å‚¨

```javascript
// ä¿å­˜ API Key
localStorage.setItem('zhipuai_api_key', apiKey);

// è¯»å– API Key
const apiKey = localStorage.getItem('zhipuai_api_key');

// å‘é€è¯·æ±‚
fetch('/api/chat', {
    headers: {
        'Authorization': `Bearer ${apiKey}`,
        'Content-Type': 'application/json'
    },
    body: JSON.stringify(data)
});
```

### åç«¯éªŒè¯

```python
from flask import request
from zhipuai import ZhipuAI

def get_zhipu_client():
    # ä»è¯·æ±‚å¤´è·å– API Key
    auth_header = request.headers.get('Authorization')
    
    # éªŒè¯æ ¼å¼
    if not auth_header or not auth_header.startswith('Bearer '):
        return None, error_response
    
    # æå– API Key
    api_key = auth_header.split(' ')[1]
    
    # åˆ›å»ºå®¢æˆ·ç«¯
    client = ZhipuAI(api_key=api_key)
    return client, None
```

---

## ğŸ¯ æœ€ä½³å®è·µ

### ç”¨æˆ·ç«¯

1. **ä¿æŠ¤ API Key**
   - ä¸è¦åˆ†äº«ç»™ä»–äºº
   - å®šæœŸæ›´æ¢
   - ç›‘æ§ä½¿ç”¨æƒ…å†µ

2. **é…ç½®å»ºè®®**
   - ä½¿ç”¨æµè§ˆå™¨çš„å¯†ç ç®¡ç†å™¨ä¿å­˜
   - åœ¨æ™ºè°±AIæ§åˆ¶å°è®¾ç½®ä½¿ç”¨é™é¢
   - å®šæœŸæ£€æŸ¥ API è°ƒç”¨è®°å½•

### å¼€å‘ç«¯

1. **å®‰å…¨æªæ–½**
   - ä½¿ç”¨ HTTPS ä¼ è¾“
   - ä¸åœ¨æ—¥å¿—ä¸­è®°å½• API Key
   - å®ç°è¯·æ±‚é¢‘ç‡é™åˆ¶

2. **ç”¨æˆ·ä½“éªŒ**
   - æä¾›æ¸…æ™°çš„é…ç½®æŒ‡å¼•
   - API Key è¾“å…¥æ¡†æ”¯æŒæ˜¾ç¤º/éšè—
   - æä¾› API Key æœ‰æ•ˆæ€§éªŒè¯

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- **ç”¨æˆ·æŒ‡å—**: `frontend/help.html`
- **API æœåŠ¡**: `backend/services/api_service.py`
- **éƒ¨ç½²æŒ‡å—**: `RENDER_DEPLOYMENT_GUIDE.md`

---

## ğŸ”„ æœªæ¥æ‰©å±•

å¯ä»¥è€ƒè™‘çš„å¢å¼ºåŠŸèƒ½ï¼š

1. **å¤š API æ”¯æŒ**
   - æ”¯æŒå¤šä¸ª AI æœåŠ¡å•†
   - ç”¨æˆ·å¯ä»¥é…ç½®å¤šä¸ª API Key
   - è‡ªåŠ¨åˆ‡æ¢æˆ–è´Ÿè½½å‡è¡¡

2. **API Key ç®¡ç†**
   - åŠ å¯†å­˜å‚¨
   - æœ‰æ•ˆæœŸç®¡ç†
   - ä½¿ç”¨ç»Ÿè®¡

3. **å›¢é˜ŸåŠŸèƒ½**
   - å›¢é˜Ÿå…±äº« API Key
   - ä½¿ç”¨é…é¢åˆ†é…
   - æˆæœ¬åˆ†æ‘Š

---

**æ€»ç»“ï¼š** å½“å‰çš„ç”¨æˆ·è‡ªé…ç½® API Key è®¾è®¡æ›´å®‰å…¨ã€æ›´çµæ´»ã€æ›´é€‚åˆå¤šç”¨æˆ·åœºæ™¯ã€‚âœ…
